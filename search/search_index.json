{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Informaci\u00f3 del m\u00f2dul","text":""},{"location":"#professorat","title":"Professorat","text":"<ul> <li>Paco Galera</li> <li>Javier Beteta</li> </ul>"},{"location":"#serveis-en-xarxa","title":"Serveis en Xarxa","text":"<ul> <li>2n Sistemes Microinform\u00e0tics i en Xarxa (SMX)</li> <li>IES Jaume II el Just</li> <li>Tavernes de la Valldigna</li> <li>AULES</li> </ul>"},{"location":"#continguts","title":"Continguts","text":"<ol> <li>Interconnexi\u00f3 de xarxes</li> <li>Acc\u00e9s remot</li> <li>DHCP</li> <li>DNS</li> <li>HTTP</li> <li>FTP</li> <li>Proxy</li> <li>Wi-Fi</li> </ol>"},{"location":"#avaluacio","title":"Avaluaci\u00f3","text":"<ul> <li>70% Examen</li> <li>20% Pr\u00e0ctiques</li> <li>10% Actitut</li> </ul> <p>Consideracions</p> <ul> <li>Activitats marcades com NEVAL es consideraran APTES o NO APTES. Aquestes activitats tindran una incid\u00e8ncia directa en l'actitut.</li> <li>Activitats marcades com a EVAL es puntuaran del 0 a 10.</li> <li>La nota final de cada avaluaci\u00f3: Examens * 0.7 + Pr\u00e0ctiques * 0.2 + Actitut * 0.1</li> </ul>"},{"location":"SMX2-SXA-1/","title":"UD1. Interconnexi\u00f3 de xarxes","text":""},{"location":"SMX2-SXA-1/#configuracio-de-la-xarxa","title":"Configuraci\u00f3 de la xarxa","text":"<p>Anem a veure comandes de terminal que existeixen per poder comprovar la nostra configuraci\u00f3 de la xarxa i com modificar alguns par\u00e0metres:</p> <ul> <li>Hostname o nom de l'equip</li> <li>Adre\u00e7a MAC</li> <li>Adre\u00e7a IP, m\u00e0scara de xarxa, adre\u00e7a de xarxa i adre\u00e7a de broadcast</li> <li>Gateway o porta d'enlla\u00e7</li> <li>Servidor DNS</li> <li>Propietats d'una connexi\u00f3 de xarxa</li> </ul>"},{"location":"SMX2-SXA-1/#nom-de-lequip","title":"Nom de l'equip","text":"<p>El hostname d'un equip \u00e9s el nom que s'assigna a aquest dispositiu dins d'una xarxa i algunes de les seues funcions son:</p> <ol> <li> <p>Identificaci\u00f3 de l'equip: El hostname \u00e9s una etiqueta \u00fanica que permet identificar un ordinador o dispositiu en una xarxa. \u00c9s com el nom propi de l'equip dins del context de la xarxa.</p> </li> <li> <p>Resoluci\u00f3 de noms: Quan es realitza una comunicaci\u00f3 a trav\u00e9s de la xarxa, els dispositius utilitzen adreces IP per trobar-se. El hostname es tradueix a una adre\u00e7a IP mitjan\u00e7ant el DNS (Domain Name System). Aix\u00f2 permet que els usuaris puguin accedir als recursos de xarxa utilitzant noms amigables en lloc d'adreces IP num\u00e8riques.</p> </li> <li> <p>Configuraci\u00f3 de serveis: El hostname tamb\u00e9 es fa servir per configurar serveis i aplicacions en un servidor. Per exemple, quan configures un servidor web, pots associar un hostname (com \"www.example.com\") a una determinada carpeta o aplicaci\u00f3 web.</p> </li> </ol> <p>En resum, el hostname \u00e9s una etiqueta que identifica un equip a la xarxa i facilita la comunicaci\u00f3 entre els dispositius mitjan\u00e7ant noms amigables.</p> <p></p>"},{"location":"SMX2-SXA-1/#adreca-ip-mascara-mac-i-adreca-de-broadcast","title":"Adre\u00e7a IP, M\u00e0scara, MAC i Adre\u00e7a de broadcast","text":"<p>El comandament que emprarem en sistemes Linux per obtindre informaci\u00f3 rellevant de la xarxa \u00e9s <code>ip a</code>. Amb aquest comandament obtindrem: adre\u00e7a IP i m\u00e0scara en format curt (etiqueta inet), Adre\u00e7a MAC (etiqueta link/ether) i adre\u00e7a de broadcast (etiqueta brd) de cadascun dels adaptadors de xarxa que tinguem instal\u00b7lats. L'adre\u00e7a de la xarxa no ens la mostra, per\u00f2 com em vist en unitats anteriors, la podem obtindre realitzant l'operaci\u00f3 IP AND M\u00e0scara.</p> <p>A sistemes Windows, el comandament equivalent \u00e9s <code>\u00ecpconfig /all</code>.</p> <p></p>"},{"location":"SMX2-SXA-1/#porta-denllac","title":"Porta d'enlla\u00e7","text":"<p>En Linux, la porta d'enlla\u00e7 o gateway s'obtenen gr\u00e0cies al comandament <code>ip r</code>. La linia que indica la porta d'enlla\u00e7 \u00e9s la que est\u00e0 etiquetada com a default.</p> <p>En sistemes windows, la porta d'enlla\u00e7 ve indicada tamb\u00e9 amb el comandament <code>ipconfig /all</code>.</p> <p></p>"},{"location":"SMX2-SXA-1/#servidors-dns","title":"Servidors DNS","text":"<p>Per obtindre informaci\u00f3 referent als servidors DNS configurats en sistemes Linux, haurem de consultar un fitxer mitjan\u00e7ant el comandament <code>cat /etc/resolv.conf</code>. Si al fitxer ens diu que el nameserver \u00e9s el 127.0.0.X significa que NetworkManager est\u00e0 configurat per iniciar una inst\u00e0ncia de la aplicaci\u00f3 dnsmasq que \u00e9s un servei local de reenviament de servidor de noms. Podem llavors, obtindre m\u00e9s infomaci\u00f3 amb el comandament <code>resolvectl status</code>.</p> <p>Novament, a sistemes Windows, aquesta informaci\u00f3 ens la donar\u00e0 el comandament <code>\u00ecpconfig /all</code>.</p>"},{"location":"SMX2-SXA-1/#informacio-del-driver-i-de-la-connexio","title":"Informaci\u00f3 del driver i de la connexi\u00f3","text":"<p>A sistemes Linux, aquesta informaci\u00f3 l'obtenim amb el comandament <code>ethtool</code>:</p> <ul> <li>Informacic\u00f3 del driver: <code>ethtool -i &lt;adaptador_xarxa&gt;</code></li> <li>Informaci\u00f3 de la connexi\u00f3: <code>ethtool &lt;adaptador_xarxa&gt;</code></li> </ul>"},{"location":"SMX2-SXA-1/#conexions-sense-fils","title":"Conexions sense fils","text":"<p>A sistemes Linux, emprarem el camndament <code>iwlist scan</code>per veure informaci\u00f3 extra, el comandament <code>iwconfig</code>. Sols mostrar\u00e0 informaci\u00f3 d'aquells adapatdors sense fils presents al sistema, evidentment.</p>"},{"location":"SMX2-SXA-1/#test-de-velocitat-de-la-xarxa-local","title":"Test de velocitat de la xarxa local","text":"<p>IPERF \u00e9s una ferramenta que s'utilitza per fer proves de velocitat en xarxes. Iperf crea fluxes de dades TCP i/o UDP i realitza un informe amb marques de temps amb la quantitat de dades transmeses i el rendiment mig. A\u00e7\u00f2 pot ser d'utilitat per comparar la velocitat de les tomes d'equips de xarxa cablejats i sense fils de forma imparcial.</p> <p>Es tracta de software de codi obert i pot executar-se en diverses plataformes incloent Linux, Unix i Windows. Per instalar-lo en sistemes Debian (Ubuntu) hem d'executar <code>sudo apt install iperf</code>.</p> <p>Iperf pot funcionar com a client (-c) o com a servidor (-s) i pot mesurar el rendiment entre els dos extrems de la comunicaci\u00f3 , unidireccional o bidireccionalment. Quan l'executem com a client (-c) hem d'afegir tamb\u00e9 l'adre\u00e7a IP de l'equip que actua com a servidor (-s).</p> <p>P\u00e0gina web del software Iperf</p> <p></p>"},{"location":"SMX2-SXA-1/#adaptadors-de-xarxa-en-virtualbox","title":"Adaptadors de xarxa en VirtualBox","text":"<p>Una m\u00e0quina virtual (MV) en VirtualBox (VB) pot tenir fins a 8 targetes de xarxa PCI Ethernet, i cadascuna d'elles, de manera independent, pot tenir assignat el tipus de hardware a virtualitzar i el seu propi mode de configuraci\u00f3. Des de l'administrador de VB es poden configurar 4 de les 8 targetes de xarxa, si ens feren falta m\u00e9s, hauriem de configurar-les per terminal mitjan\u00e7ant el programa VBoxManage.</p> <p>Per tal de configurar la xarxa del sistema virtualitzat, haurem de seleccionar la MV a la pantalla principal del VB i entrar en \"Configuraci\u00f3\" --&gt; \"Xarxa\".</p> <p></p> <p>Mitjan\u00e7ant el desplegable \"Connectat a:\" tindrem, en general, les seg\u00fcents opcions:</p> <ul> <li>NAT</li> <li>Xarxa NAT</li> <li>Adaptador pont</li> <li>Adaptador sols-amfitri\u00f3</li> <li>Xarxa interna</li> <li>No connectat</li> </ul> <p>Per a qu\u00e8 serveix el protocol NAT?</p> <p>NAT \u00e9s un protocol que fou creat per traduir les IPs privades de la xarxa en una IP p\u00fablica perqu\u00e8 la xarxa poguera enviar paquets a l'exterior; i traduir despr\u00e9s eixa IP p\u00fablica, de nou a la IP privada de l'equip que havia enviat el paquet, per tal que poguera rebre'l una vegada arribada la resposta.</p> <p></p>"},{"location":"SMX2-SXA-1/#nat-en-virtualbox","title":"NAT en VirtualBox","text":"<p>A VB \u00e9s el mode per defecte de la targeta de xarxa virtual. Amb aquesta opci\u00f3 el servei virtualitzat utilitza la targeta de xarxa de la m\u00e0quina real (amfitri\u00f3) per navegar. En mode NAT, VB col\u00b7loca un router entre l'amfitri\u00f3 (cap on fa NAT) i la m\u00e0quina virtual.</p> <p>Aquest router poseeix un servidor DHCP que serveix cap a l'interior i mapeja el tr\u00e0fic des de i cap a la MV de manera transparent. D'aquesta forma, si tenim configurat el client DHCP en el SO de la MV (opci\u00f3 habitualment per defecte), en mode NAT tindrem Internet autom\u00e0ticament a la MV.</p> <p>Cada MV en mode NAT tindr\u00e0 el seu propi router, per la qual cosa estaran en xarxes a\u00efllades, el que implica que, per defecte, les MMVV que tenen la seua targeta en mode NAT no poden veure's entre elles.</p> <p>L'adre\u00e7a que el router (intern) serveix (DHCP) va a dependre del n\u00famero de targeta de xarxa que estiga assignat en mode NAT. Les 8 targetes de xarxa que VB permet a cada MV van numerades del 0 al 7 i les adreces de xarxa dels routers segueixen el patr\u00f3 10.0.[x + 2].0/24, on x \u00e9s el n\u00famero de la targeta de xarxa (10.0.2.0/24, 10.0.3.0/24, ... , 10.0.9.0/24 ). L'adre\u00e7a IP de la targeta de xarxa ser\u00e0 10.0.x+2.15/24 i la porta d'enlla\u00e7 (router intern) 10.0.x+2.2/24.</p> Canvi d'adre\u00e7ament NAT en VirtualBox <p>Pot ser interessant canviar la numeraci\u00f3 motivats per el problema que estiguem resolent en un moment donat, i per fer-ho \u00e9s necessari rec\u00f2rrer al comandament VBoxManage de la seg\u00fcent forma:</p> <p><code>VBoxManage modifyvm \"Nom_de_la_MV\" --natnet1 192.168.0.0/16</code></p> <p>Amb l'ordre anterior, l'adaptador de xarxa n\u00famero 0 (--natnet1) de la MV \"Nom_de_la_MV\" pendr\u00e0 l'adre\u00e7a de xarxa 192.168.0.15/16 i la porta d'enlla\u00e7 192.168.0.2/16.</p> <p>Un desavantatge d'aquest mode, com hem vist, \u00e9s que la MV \u00e9s invisible i inalca\u00e7able fora de la seua xarxa i per tant, no podem instal\u00b7lar un servidor d'aquesta manera, a no ser que configurem el reenviament de ports. La qual cosa no est\u00e0 mal des del punt de vista de la seguretat.</p> Reenviament de ports en xarxa NAT de VirtualBox <p>Si per exemple, a la MV col\u00b7loquem un servidor SSH i volem que les peticions SSH al port 2222 de l'amfitri\u00f3 passen al port 22 del convidat (MV), on est\u00e0 el servidor SSH, redireccionarem els ports de la seg\u00fcent forma:</p> <p><code>VBoxManage modifyvm \"Nom_de_la_MV\" --natpf1 \"servidorSSH, tcp,, 2222,, 22\"</code></p> <p>Al posar --natpf1, estem dient que l'adaptador de xarxa 0 est\u00e0 en mode NAT i per ell rebr\u00e0 les peticions el servidor SSH</p> <p>El nom servidorSSH \u00e9s u nnom simb\u00f2lic que emprarem per gestionar aquesta redirecci\u00f3, per exemple, si volem eliminar-la:</p> <p><code>VBoxManage modifyvm \"Nom_de_la_MV\" --natpf1 delete servidorSSH</code></p> <p>En una redirecci\u00f3 on hem d'especificar les IPs, per exemple, l'amfitri\u00f3 t\u00e9 varies targetes i el convidatl'hem configurat de forma est\u00e0tica* (a pesar que la targeta estiga en mode NAT i per tant es tinga un servidor DHCP), la IP de l'amfitri\u00f3 va davant del port de l'amfitri\u00f3 i la IP de convidat, davant del port del convidat:</p> <p><code>VBoxManage modifyvm \"Nom_de_la_MV\" --natpf1 \"servidorSSH, tcp, 192.168.1.5, 2222, 10.0.2.50, 22\"</code></p> <p>El redireccionament de ports es pot fer tamb\u00e9 de forma gr\u00e0fica mitjan\u00e7ant la secci\u00f3 de \"Xarxa de la MV\".</p> <p></p> <p>Per a qu\u00e8 serveix el protocol DHCP?</p> <ul> <li>DHCP \u00e9s un protocol que es configura en servidors.</li> <li>Un servidor t\u00e9 un llistat d'adreces IP din\u00e0miques i les va assignant als clients conforme aquestes van quedant lliures, sabent en tot moment qui ha estat en posessi\u00ed d'eixes IP, quan de temps la ha tingut i qui se li ha assignat despr\u00e9s.</li> <li>Aix\u00ed els clients d'un xarxa IP poden aconseguir els seus par\u00e0metres de configuraci\u00f3 autom\u00e0ticament.</li> <li>Aquest protocol es va publicar en octubre de 1993 i la seua implementaci\u00f3 actual est\u00e0 en RFC 2131.</li> <li>Per a DHCPv6 es publica el RFC 331.</li> <li>VirtualBox permet configurar el servei DHCP en diverses modalitats: NAT, Xarxa Nat, Xarxa sols-amfitri\u00f3.</li> </ul>"},{"location":"SMX2-SXA-1/#xarxa-nat-en-virtualbox","title":"Xarxa NAT en VirtualBox","text":"<p>Funciona com el router de la nostra casa, \u00e9s a dir, **els equips que estiguen dins de la mateixa Xarxa NAT podran comunicar-se entre ells, i esta \u00e9s la difer\u00e8ncia amb el mode NAT vist anteriorment, el qual sempre contruia una xarxa amb un \u00fanic equip i no de dicersos com ara \u00e9s el cas.</p> <p></p>"},{"location":"SMX2-SXA-1/#creacio-duna-xarxa-nat","title":"Creaci\u00f3 d'una xarxa NAT","text":"<p>Podem fer-ho de dues formes:</p> <ul> <li>Des de l'int\u00e8rpret de comandes escriure'm <code>VBoxManage natnetwork add --netname CASA --network 192.168.0.0/24</code>.</li> <li>Des del men\u00fa del VB (les imatges corresponen a la versi\u00f3 6 de VB): \"Fitxer --&gt; Prefer\u00e8ncies --&gt; Xarxa\"</li> </ul> <p></p> <p>Des de l'entorn gr\u00e0fic podrem, tamb\u00e9, configurar el reenviament de ports.</p> <p>Podem llistar la informaci\u00f3 de les xarxaes NAT disponibles i aix\u00ed comprovar els par\u00e0metres que acabem de crear:</p> <p><code>VBoxManage list natnets</code></p> <p>Com podem veure, sols hi ha en aquest moment una \u00fanica xarxa NAT anomenada CASA i podem destacar la seg\u00fcent informaci\u00f3:</p> <p></p> <p>El servidor DHCP pot detindre's o activar-se de manera independent, amb els seg\u00fcents comandaments:</p> <p><code>VBoxManage natnetwork modify --netname CASA --dhcp off</code></p> <p><code>VBoxManage natnetwork modify --netname CASA --dhcp on</code></p> <p>La xarxa NAT pot detindre's i seria com apagar el router, \u00e9s a dir, la xarxa quedaria sense eixida a l'exterior encara que tindria connexi\u00f3 entre els equips connectats a la mateixa xarxa NAT:</p> <p><code>VBoxManage natnetwork stop --netname CASA</code></p> <p><code>VBoxManage natnetwork start --netname CASA</code></p> <p>Finalment, per eliminar la xarxa NAT executariem:</p> <p><code>VBoxManage natnetwork remove --netname CASA</code></p> <p>Aquestes opcions tamb\u00e9 poden fer-se des de l'entonr gr\u00e0fic de VB.</p>"},{"location":"SMX2-SXA-1/#adaptador-pont-en-virtualbox","title":"Adaptador pont en VirtualBox","text":"<p>El mode \"Adaptador pont\" simula que la targeta virtual est\u00e0 connectada al mateix switch que la targeta f\u00edsica de l'amfitri\u00f3, per tant, la MV va a comportar-se com si f\u00f2s un equip m\u00e9s dins de la mateixa xarxa f\u00edsica en la que est\u00e0 l'equip amfitri\u00f3. Aix\u00ed doncs, si l'amfitri\u00f3 obt\u00e9 una adre\u00e7a IP per DHCP, el host tamb\u00e9 la conseguir\u00e0. L'esquema de xarxa seria el seg\u00fcent:</p> <p></p> <p>Com aconsegueix VB simular-ho?</p> <p>Un bridge afig un nivell d'intelig\u00e8ncia a una connexi\u00f3 entre xarxes. Connecta dos segments de xarxes iguals o distints. Podem veure un bridge com un classificador de correu que mira les adreces dels paquets i els col\u00b7loca a la xarxa adequada.</p>"},{"location":"SMX2-SXA-1/#xarxa-interna","title":"Xarxa interna","text":"<p>Amb aquesta configuraci\u00f3 de targetes de xarxa, podem contruir xarxes a\u00efllades, en les quals sols hi haur\u00e0 communicaci\u00f3 entre les MMVV que pert\u00e0nyen a la mateixa xarxa interna.</p> <p></p> <p>Per tal de connectar xarxes internes a l'exterior, haurem de crear MMVV que funcionen com routers i disposen de dues targetes de xarxa, d'aquesta forma podrem contruir un cam\u00ed cap a Internet. Aquesta m\u00e0quina que funcionaria com a router, haur\u00e0 de tindre alguna de les seues targetes en NAT o pont, per poder ixir f\u00edsicament a l'exterior.</p> <p></p> <p>Les xarxes internes de VB s'identifiquen a trev\u00e9s d'un nom i totes les MMVV que tinguen una targeta en mode xarxa interna amb el mateix nom formaran una \u00fanica xarxa. El nom de la xarxa interna s'especifica despr\u00e9s de triar el mode; si no s'especifica, s'emprar\u00e0 la xarxa interna per defecte de VB, anomenada intnet.</p> <p></p>"},{"location":"SMX2-SXA-1/#adaptador-sols-amfitrio","title":"Adaptador sols-amfitri\u00f3","text":"<p>El mode \"sols-amfitri\u00f3\" s'empra per crear un xarxa interna a la que pertanyer\u00e0 tamb\u00e9 l'equip amfitri\u00f3, cosa que no succeeix al mode \"xarxa interna\".</p> <p>Justificaci\u00f3</p> <p>La connexi\u00f3 directa en una mateixa xarxa, de l'amfitri\u00f3 amb una o m\u00e9s MMVV, ha de fer-se emprant el \"mode pont\" el qual necessita per funcionar, que el cable f\u00edsic de xarxa estiga connectat a la targeta de xarxa de l'amfitri\u00f3. En cas contrari, \u00e9s com si estiguera apagat el switch que connecta a l'amfitri\u00f3 amb les MMVV, i per tant, no existeix connexi\u00f3 entre elles, ni amb l'amfitri\u00f3. Si estigu\u00e9ssem en una situaci\u00f3 en la qual no tingu\u00e9rem connexi\u00f3 de xarxa, no podriem treballa amb la configuraci\u00f3 anterior; aquest problema el resol el mode sols-amfitri\u00f3, doncs no empra la targeta f\u00edsica de la xarxa de l'amfitri\u00f3 sino que es crea una virtual que estar\u00e0 connectada al mateix switch virtual al que estaran connectades les targetes de xarxa de les MMVV amb el mateix mode de xarxa.</p> <p>Per poder fer \u00fas d'aquest mode, haurem de crear la targeta de xarxa virtual a l'equip amfitri\u00f3, per a tal cosa a l'administraci\u00f3 de VB anirem a Fitxer -&gt; Administrador de xarxa-amfitri\u00f3.</p> <p></p> <p>A partir d'aquest moment existeixen tantes targetes noves de xarxa com creem.</p> <p>Aquestes targetes hi ha que assignar-les una IP de la xarxa que h\u00e0gem triat, i a\u00e7\u00f2es fa configurant els camps del recuadre situat en la part inferior de la finestra. Ho farem seleccionant previament vboxnet0:</p> <p></p> <p>Tamb\u00e9 podrem activar un servidor DHCP per evitar configurar manualment les targetes de xarxa de les MMVV que es connecten...</p> Error E_ACCESSDENIED <p>Algunes de les activitats i pr\u00e0ctiques proposades necessiten de la modificaci\u00f3 de les xarxes sols anfitri\u00f3, per\u00f2 podem trobar-nos davant errors al moment de configurar-ho com el seg\u00fcent:</p> <p></p> <p>Aquest error es deu a que a partir de la versi\u00f3 6.1.28 van afegir unes noves configuracions, que entre altres coses acoten el rang v\u00e0lid de xarxes disponibles per a xarxes sols anfitri\u00f3.</p> <p>A\u00e7\u00f2 desemboca en que sols s'accepten xarxes sols anfitri\u00f3 en el rang 192.168.56.0/21.</p> <p>Per deshabilitar aquesta restricci\u00f3, editarem el fitxer /etc/vbox/networks.conf (que pot no existir i haurem de crear-lo) i afegirem el rang</p> <pre><code>* 0.0.0.0/0 ::/0\n</code></pre> <p>que b\u00e0sicament habilita totes les xarxes. D'aquesta forma podrem emprar qualsevol xarxa en mode sols anfitri\u00f3.</p> <p></p> <p></p>"},{"location":"SMX2-SXA-1/#netplan","title":"Netplan","text":"<p>Amb l'arribada d' Ubuntu 18.04 arrib\u00e0ren canvis a la configuraci\u00f3 dels serveis de xarxa.</p> <p></p> <p>A les versions anteriors, tota la configuraci\u00f3 es realitzava per interf\u00edcie gr\u00e0fica o mitjan\u00e7ant fitxers de configuraci\u00f3, situats en /etc/network. A partir d'ara, tindrem les dues opcions, per\u00f2 els fitxers de configuraci\u00f3 es troben a /etc/netplan i tenen extensi\u00f3 yaml.</p> <p></p> <p>Aquest fitxer \u00e9s el que tindrem que modificar per tal d'aconseguir la configuraci\u00f3 de xarxa que necessitem en cada cas.</p> <p></p> <p>Aquesta \u00e9s la configuraci\u00f3 per defecte de la xarxa. Amb aquesta configuraci\u00f3 \u00e9s la interf\u00edcie gr\u00e0fica l'encarregada de controlar tots els dispositius de la xarxa. Aquesta opci\u00f3 s'estableix a la linia: <code>renderer: NetworkManager</code>.</p> <p>A la majoria dels casos amb aquesta configuraci\u00f3 tindrem suficient per\u00f2 no tindrem control sobre els dispossitius de la xarxa.</p> <p>Per tal d'indicar que anem a ser nosaltres els qui definim el comportament i configuraci\u00f3 de les interf\u00edcies de xarxa , haurem de modificar la linia anterior per: <code>renderer: networkd</code>.</p> <p>A partir d'aquest moment haurem d'especificar tota la informaci\u00f3 necess\u00e0ria per al funcionament dels dispositius de xarxa.</p> <p>Anem a veure diferents exemples de configuraci\u00f3ns de netplan, aquests exemples s\u00f3n b\u00e0sics per\u00f2 suficients per poder realitzar exercicis.</p> <p>Informaci\u00f3</p> <p>Abans de veure els exemple, hi ha que tindre en compte que els fitxers en format yaml no accept\u00e0ven tabulacions al principi i per tal de realitzar les sangr\u00edes del text hav\u00edem d'emprar espais.</p> <p>A les versions m\u00e9s noves d'Ubuntu el fitxers yaml ja suporten la tabulaci\u00f3.</p>"},{"location":"SMX2-SXA-1/#configurar-targeta-de-xarxa-per-dhcp","title":"Configurar targeta de xarxa per DHCP","text":"<pre><code>network:\n  version: 2\n  renderer: networkd\n  ethernets:\n    enp0s3:\n      dhcp4: yes\n</code></pre> <p>On podem veure:</p> <ul> <li><code>renderer: networkd</code> -- configurem nosaltres el dispositius de xarxa</li> <li><code>ethernets</code> -- interf\u00edcies de xarxa a aconfigurar</li> <li><code>enp0s3</code> -- nom de la interf\u00edcie de xarxa a configurar</li> <li><code>dhcp4: yes</code> -- DHCP activat</li> </ul> <p>Aquest tipus de configuaci\u00f3 la utilitzarem quan tinguem una targeta de xarxa sobre un adaptador de VirtualBox que accepte DHCP, \u00e9s a dir, NAT, Xarxa NAT i Sols anfitri\u00f3.</p>"},{"location":"SMX2-SXA-1/#configurar-targeta-de-xarxa-amb-ip-fixa","title":"Configurar targeta de xarxa amb IP fixa","text":"<p><pre><code>network:\n  version: 2\n  renderer: networkd\n  ethernets:\n    enp0s3:\n      addresses: [10.0.2.10/24]\n      nameservers:\n        addresses: [8.8.8.8, 8.8.4.4]\n      routes:\n        - to: default\n          via: 10.0.2.2\n</code></pre> A banda dels punts anteriors podem veure:</p> <ul> <li><code>addresses: [10.0.2.10/24]</code> -- adre\u00e7a de xarxa en format CIDR</li> <li><code>nameservers:</code> -- a partir d'aquesta linia, configuraci\u00f3 dels DNS.</li> <li><code>routes:</code> -- gesti\u00f3 d'enrutament local, per exemple: porta d'enlla\u00e7 (to: default - via...)</li> </ul> <p>Gateway4 deprecated</p> <pre><code>network:\n    version: 2\n    renderer: networkd\n    ethernets:\n        enp0s3:\n            address: [10.10.10.2/24]\n            gateway4: 10.10.10.1\n            nameservers:\n                addresses: [8.8.8.8, 8.8.4.4]\n</code></pre>"},{"location":"SMX2-SXA-1/#aplicar-les-configuracions","title":"Aplicar les configuracions","text":"<p>La modificaci\u00f3 del fitxer ubicat en /etc/netplan/ no implica que s'apliquen els canvis.  Cada vegada que modifiquem aquest fitxer yaml haurem de realitzar algunes accions:</p> <ul> <li><code>sudo netplan -debug try</code>: tracta d'aplicar la configuraci\u00f3 que hem definit. Si no hi ha errades ixir\u00e0 un contador per tornar a la configuraci\u00f3 anterior o polsant ENTER aplicar la nova.</li> <li><code>sudo netplan apply</code>: aplica directament la configuraci\u00f3 que hem definit. S'ha d'emprar en el cas d'estar completament segur que tot \u00e9s correcte.</li> </ul> <p></p>"},{"location":"SMX2-SXA-2/","title":"UD2. Acc\u00e9s remot","text":""},{"location":"SMX2-SXA-2/#introduccio","title":"Introducci\u00f3","text":"<p>La capacitat per accedir remotament a arxius i informaci\u00f3 en el vostre ordinador a trav\u00e9s d\u2019Internet \u00e9s \u00fatil tant per treballar com per jugar. Pot ser \u00fatil tant per recuperar un arxiu oblidat a l\u2019ordinador com per permetre a un administrador de sistemes accedir a un servidor i modificar-ne la configuraci\u00f3. Tamb\u00e9 \u00e9s utilitzat per les companyies per permetre que els seus treballadors accedeixin al seu sistema i aix\u00ed poder utilitzar informaci\u00f3 important, ja sigui des de les oficines del client o des de casa seva.</p> <p>Aquest \u00fas tan diversificat fa que hi hagi moltes tecnologies disponibles per permetre aquest tipus d\u2019acc\u00e9s: des del sistema de fitxers compartit incorporat en la majoria de sistemes operatius fins a eines m\u00e9s espec\u00edfiques desenvolupades per empreses.</p> <p>L\u2019\u00fas tan divers fa que tamb\u00e9 hi hagi una gran diversitat de maneres i mitjans d\u2019accedir remotament a informaci\u00f3. Per fer front a la diversitat hi ha diferents protocols i eines que permeten tenir acc\u00e9s des d\u2019un port\u00e0til amb connexi\u00f3 WiFi, un tel\u00e8fon m\u00f2bil amb GPRS o una connexi\u00f3 fixa d\u2019Internet.</p> <p>Tamb\u00e9 val a dir que mentre que gaireb\u00e9 sempre pensem en acc\u00e9s remot a ordinadors o servidors, hi ha un altre tipus d\u2019acc\u00e9s remot que cada cop t\u00e9 m\u00e9s difusi\u00f3: l\u2019acc\u00e9s remot a dispositius dom\u00e8stics.</p> <p>A una casa podem trobar molts dispositius que es poden controlar remotament. Per exemple, mentre estem de vacances podem connectar remotament algun llum per fer veure que hi ha alguna persona a casa i dissuadir els possibles lladres. Aquesta tecnologia, amb la propera implantaci\u00f3 del protocol IPv6 es far\u00e0 extensible a un nombre encara m\u00e9s elevat i a m\u00e9s tipus de dispositius i electrodom\u00e8stics. Encara que s\u2019escapa dels objectius d\u2019aquesta unitat formativa, vol\u00edem fer una pinzellada per mostrar que l\u2019acc\u00e9s remot t\u00e9 cada cop m\u00e9s import\u00e0ncia i que, en un futur immediat, estar\u00e0 present en aspectes molt diversos de les nostres vides.</p> <p>Cal saber...</p> <ul> <li>LAN: Una LAN (de l\u2019angl\u00e8s local area network o xarxa d\u2019\u00e0rea local) \u00e9s un tipus de xarxa inform\u00e0tica caracteritzada pel seu car\u00e0cter \u201clocal\u201d o de dist\u00e0ncia curta, com ara una casa, una oficina, un hotel, etc., \u00e9s a dir, la seva extensi\u00f3 est\u00e0 limitada a uns 200 metres i podria arribar a un quil\u00f2metre si es fessin servir repetidors.</li> <li>TELNET: \u00c9s un protocol que emula un terminal remot per connectar-se a una m\u00e0quina multiusuari. El seu principal problema \u00e9s la seguretat.</li> <li>SSH: (Secure SHell) \u00e9s el nom d\u2019un protocol i del programa que l\u2019implementa, i serveix per accedir a m\u00e0quines remotes a trav\u00e9s de la xarxa. Permet gestionar completament l\u2019ordinador mitjan\u00e7ant l\u2019int\u00e8rpret d\u2019ordres.</li> <li>GPRS: \u00c9s l\u2019acr\u00f2nim de general packet radio service (servei general de paquets via r\u00e0dio). \u00c9s el sistema que, afegit al GSM, permet la transmissi\u00f3 de paquets de dades no vocals.</li> <li>IPv6: \u00c9s la versi\u00f3 6 del protocol d\u2019Internet (IP), un est\u00e0ndard de nivell de xarxa que s\u2019encarrega de dirigir i encaminar els paquets commutats. Est\u00e0 dissenyat per substituir l\u2019actual IPv4, ja que el seu l\u00edmit en el nombre d\u2019adreces de xarxa disponibles est\u00e0 comen\u00e7ant a restringir el creixement d\u2019Internet (l\u2019elevat increment d\u2019assignacions a zones d\u2019\u00c0sia n\u2019est\u00e0 accelerant l\u2019exhauriment). Actualment, ja hi ha assignades m\u00e9s de 2/3 parts de qu\u00e8 disposa. La nova IPv6 permetr\u00e0 proporcionar als futurs tel\u00e8fons cel\u00b7lulars i m\u00f2bils una direcci\u00f3 fixa i pr\u00f2pia per a cada un d\u2019ells.</li> </ul>"},{"location":"SMX2-SXA-2/#usos-mes-frequents-de-lacces-remot-a-ordinadors","title":"Usos m\u00e9s freq\u00fcents de l'acc\u00e9s remot a ordinadors","text":"<p>El programari que permet l\u2019administraci\u00f3 remota \u00e9s cada vegada m\u00e9s com\u00fa i s\u2019utilitza sovint quan \u00e9s dif\u00edcil o molt dif\u00edcil estar f\u00edsicament a prop d\u2019un sistema per usar-lo o per tal d\u2019accedir al material d\u2019Internet que no est\u00e0 disponible en la mateixa ubicaci\u00f3.</p> <p>Els servidors i altres equips de xarxa, per diverses raons, a vegades es distribueixen a dist\u00e0ncies considerables. Fins i tot quan estan relativament a prop, dins del mateix edifici o la mateixa planta, poden estar instal\u00b7lats en espais amb acc\u00e9s dificult\u00f3s o restringit. Per aquestes raons l\u2019administraci\u00f3 remota, \u00e9s a dir l\u2019administraci\u00f3 d\u2019un equip des d\u2019un altre equip, \u00e9s una necessitat quotidiana.</p> <p>A continuaci\u00f3 mostrem una llista d\u2019algunes de les tasques m\u00e9s comunes:</p> <ul> <li>Generals: controlar un ordinador des d\u2019un lloc remot. Per exemple: accedir a un ordinador personal des d\u2019un caf\u00e8 d\u2019Internet.<ul> <li>Apagar o reiniciar un ordinador remot.</li> </ul> </li> <li>Accedir a perif\u00e8rics<ul> <li>\u00das d\u2019un perif\u00e8ric connectat a la xarxa, com per exemple una impressora.</li> <li>Recuperar dades d\u2019un flux de dades, com per exemple de les c\u00e0meres d\u2019un circuit tancat de televisi\u00f3.</li> </ul> </li> <li>Modificar dades<ul> <li>Modificar la configuraci\u00f3 d\u2019un ordinador remot.</li> <li>Modificar el serveis que hi ha configurats en un servidor.</li> <li>Instal\u00b7lar o desinstal\u00b7lar programari en un ordinador remot.</li> </ul> </li> <li>Visualitzar<ul> <li>Assist\u00e8ncia remota a usuaris.</li> <li>Supervisar l\u2019\u00fas d\u2019un ordinador o de la navegaci\u00f3 per Internet.</li> </ul> </li> </ul>"},{"location":"SMX2-SXA-2/#diferents-tipus-dacces-remot","title":"Diferents tipus d'acc\u00e9s remot","text":"<p>Les tasques d\u2019acc\u00e9s i administraci\u00f3 remots es poden dur a terme amb mitjans diferents, per\u00f2 sempre estaran condicionats per la xarxa que connecta l\u2019equip que cal administrar amb l\u2019estaci\u00f3 on est\u00e0 l\u2019administrador.</p> <p>La xarxa imposar\u00e0 condicions de:</p> <ul> <li>Capacitat: si la connexi\u00f3 no t\u00e9 una amplada de banda suficient no ser\u00e0 pr\u00e0ctic treballar amb una interf\u00edcie gr\u00e0fica remota. Com m\u00e9s augmenti el retard en la xarxa m\u00e9s frustrant ser\u00e0 el treball interactiu.</li> <li>Seguretat: \u00e9s obvi que la comunicaci\u00f3 entre l\u2019administrador i l\u2019equip remot no ha de ser interceptada per altres usuaris de la xarxa.</li> </ul> <p>Els diferents mitjans d\u2019administraci\u00f3 remota es poden classificar en tres categories b\u00e0siques:</p> <ul> <li>Sessi\u00f3 de treball a la consola</li> <li>Sessi\u00f3 de treball amb interf\u00edcie gr\u00e0fica</li> <li>Client o eina d\u2019administraci\u00f3 local</li> </ul> <p>Cada categoria t\u00e9 els seus punts forts i febles. Una sessi\u00f3 de treball a la consola mitjan\u00e7ant SSH, o l\u2019obsolet i insegur Telnet, no exigeix grans capacitats a la xarxa. \u00c9s el m\u00e8tode m\u00e9s lleuger i fins i tot es pot utilitzar amb comoditat per administrar m\u00e0quines molt distants o amb xarxes de capacitat escassa. A m\u00e9s, \u00e9s relativament senzill automatitzar tasques mitjan\u00e7ant guions de programaci\u00f3 per repetir les mateixes operacions en un conjunt de m\u00e0quines.</p> <p>L\u2019administraci\u00f3 remota amb interf\u00edcie gr\u00e0fica permet obrir a l\u2019estaci\u00f3 local finestres d\u2019aplicacions que s\u2019executen en el servidor remot. Fins i tot permet veure l\u2019escriptori complet de l\u2019estaci\u00f3 remota. Tot i que pot ser un m\u00e8tode de treball c\u00f2mode, requereix capacitats de la xarxa que normalment nom\u00e9s es troben disponibles dins d\u2019una LAN.</p> <p>Emprar una eina d\u2019administraci\u00f3 local feta a mida, com un assistent per configurar una impressora remota, o gen\u00e8rica, com un navegador web, intenta conjugar punts forts de les dues t\u00e8cniques anteriors. En aquest cas l\u2019administrador dialoga amb una aplicaci\u00f3 local o una p\u00e0gina web i no necessita recordar ordres. A m\u00e9s, donat que la representaci\u00f3 gr\u00e0fica es produeix localment no s\u2019exigeix gran capacitat a la xarxa. El problema de les eines espec\u00edfiques \u00e9s que es tracta d\u2019un programari que cal instal\u00b7lar a cada estaci\u00f3 que l\u2019administrador vulgui emprar. Sovint aquesta eina nom\u00e9s est\u00e0 disponible per a un sistema operatiu o per a una versi\u00f3 determinada d\u2019aquest. Aquest problema s\u2019obvia amb les interf\u00edcies web, ja que un navegador web \u00e9s un programari com\u00fa que es troba en tots els equips. En la taula.1 podeu veure un resum dels principals avantatges i inconvenients.</p> M\u00e8tode d'administraci\u00f3 Avantatges Inconvenients Treball a la l\u00ednia d\u2019ordres Requisits m\u00ednims per a la xarxa. \u00c9s flexible i es pot automatitzar. Cal con\u00e8ixer la sintaxi i recordar les ordres Interf\u00edcie gr\u00e0fica Visual i flexible. No cal recordar ordres. Imposa requisits de capacitat a la xarxa Client local Visual i flexible. No cal recordar ordres. No consumeix gaires recursos a la xarxa. Si no es tracta d\u2019una interf\u00edcie web, cal instal\u00b7lar programari. <p>En l'actualitat algunes de les ferramentes d'administraci\u00f3 remota m\u00e9s utilitzades s\u00f3n:</p> <ul> <li>En mode text (l\u00ednia d'ordres): telnet, Secure Shell (SSH).</li> <li>En mode gr\u00e0fic (interf\u00edcie gr\u00e0fica): VNC, Terminal Server.</li> <li>Client local (interf\u00edcies web): La majoria de dispositius disposen d'un servidor web lleuger que permet la seua configuraci\u00f3. Tamb\u00e9 hi ha aplicacions com Webmin per a servidor basats en Linux.</li> </ul>"},{"location":"SMX2-SXA-2/#acces-remot-amb-linia-dordres","title":"Acc\u00e9s remot amb l\u00ednia d'ordres","text":""},{"location":"SMX2-SXA-2/#telnet","title":"Telnet","text":"<p>Telnet \u00e9s un protocol que emula un terminal remot per a connectar-se a una m\u00e0quina multiusuari. Igual que amb el protocol FTP, cal el programari necessari i un protocol espec\u00edfic per aquest servei.</p> <p>El port que s'utilitza \u00e9s generalment el 23. Nom\u00e9s serveix per accedir-hi en mode terminal, \u00e9s a dir, sense gr\u00e0fics, per\u00f2 va ser una eina molt \u00fatil per arreglar problemes a dist\u00e0ncia. Tamb\u00e9 s'ha fet servir per consultar dades a dist\u00e0ncia, com dades personals accessibles a trav\u00e9s de la xarxa, informaci\u00f3 bibliogr\u00e0fica, etc. Els requisits per accedir a aquest servei s\u00f3n molt senzills: con\u00e8ixer el nom i l'adre\u00e7a del servidor remot i estar habilitat per a poder utilitzar-lo mitjan\u00e7ant un identificador d'usuari i una contrasenya. Normalment es crida a una aplicaci\u00f3 externa que \u00e9s la que realitza la connexi\u00f3. En aquest cas s'ha d'indicar la m\u00e0quina i el login: <code>telnet://maquina.domini@login</code>.</p> <p>El seu principal problema \u00e9s de seguretat, ja que tots els noms d'usuari i contrasenyes necess\u00e0ries per entrar a les m\u00e0quines viatjaven per la xarxa sense xifrar. Aix\u00f2 feia que qualsevol persona que espies el tr\u00e0fic de la xarxa pogu\u00e9s obtenir aquestes dades i d'aquesta manera accedir tamb\u00e9 a les m\u00e0quines. Es va deixar de fer servir quasi totalment, fa uns anys, quan va apar\u00e8ixer i es va popularitzar l'SSH, que es pot descriure com una versi\u00f3 xifrada de Telnet.</p> PR\u00c0CTICA 1: Acc\u00e9s remot mitjan\u00e7ant Telnet <p>L\u2019objectiu d\u2019aquesta activitat \u00e9s utilitzar el programari Telnet per accedir remotament a una m\u00e0quina.</p> <p>Per fer aquesta pr\u00e0ctica haureu de disposar de dues m\u00e0quines, la local i la remota. En cas que no fos aix\u00ed, podeu instal\u00b7lar el client i el servidor a la mateixa m\u00e0quina.</p> <p>Seguiu les instruccions seg\u00fcents per fer l'activitat.</p> <ol> <li> <p>Instal\u00b7leu el programa client i el servidor Telnet: <code>telnet</code> i <code>telnetd</code> en el Ubuntu Server de la m\u00e0quina virtual.</p> </li> <li> <p>Un cop instal\u00b7lats tots els paquets de programari, procediu a reiniciar els serveis de xarxa.</p> </li> <li> <p>Accediu remotament des del client al servidor i feu una llista del contingut del directori de connexi\u00f3.</p> </li> <li> <p>Accediu des del client Windows i tracteu de capturar els paquets amb Wireshark per a aconseguir la contrasenya.</p> </li> </ol> <p>Documenta el proc\u00e9s amb captures i comentaris.</p>"},{"location":"SMX2-SXA-2/#introduccio-a-la-criptografia","title":"Introducci\u00f3 a la criptografia","text":"<p>La criptografia ens aporta t\u00e8cniques per encriptar i desencriptar informaci\u00f3, de manera que es puguin transmetre, amb seguretat, missatges per un canal que no \u00e9s de confian\u00e7a. L\u2019objectiu evident \u00e9s assegurar que el missatge transm\u00e8s romandr\u00e0 secret. Per\u00f2 a les comunicacions electr\u00f2niques tamb\u00e9 s\u2019utilitza sovint per autenticar que l\u2019emissor i el destinatari del missatge s\u00f3n qui pensem i per garantir que el mateix missatge no ha estat alterat durant la seva transmissi\u00f3.</p> <p>Hi ha diferents t\u00e8cniques criptogr\u00e0fiques, per\u00f2 dues de les m\u00e9s emprades s\u00f3n:</p> <ul> <li>Criptografia sim\u00e8trica o de clau compartida</li> <li>Criptografia asim\u00e8trica o de clau p\u00fablica</li> </ul>"},{"location":"SMX2-SXA-2/#criptografia-de-clau-compartida","title":"Criptografia de clau compartida","text":"<p>En emprar un algorisme d\u2019encriptaci\u00f3 de clau compartida s\u2019utilitza la mateixa clau per encriptar i desencriptar. Aquesta caracter\u00edstica \u00e9s el seu principal inconvenient, ja que si es vol canviar la clau es necessitar\u00e0 un mitj\u00e0 de comunicaci\u00f3 segur per fer-la arribar de l\u2019emissor al receptor. El principal avantatge de la criptografia sim\u00e8trica \u00e9s la seva velocitat. Alguns algorismes d\u2019encriptaci\u00f3 sim\u00e8trics s\u00f3n: 3DES, AES, Blowfish i IDEA.</p>"},{"location":"SMX2-SXA-2/#criptografia-de-clau-publica","title":"Criptografia de clau p\u00fablica","text":"<p>La criptografia asim\u00e8trica o de clau p\u00fablica evita el problema de l\u2019intercanvi de claus. En aquest cast, tant l\u2019emissor com el receptor tindran una parella de claus diferents. A cada parella de claus n\u2019hi ha una de p\u00fablica i una de privada. La clau privada mai no viatja pel canal de comunicaci\u00f3, cal garantir-ne la protecci\u00f3. La clau p\u00fablica, com el seu nom indica, es pot oferir a tothom que la demani, pot viatjar per mitjans insegurs o fins i tot es pot publicar.</p> <p>Cada parella de claus est\u00e0 fortament relacionada:</p> <ul> <li>Els missatges que s\u2019encripten emprant una clau p\u00fablica nom\u00e9s es poden desencriptar mitjan\u00e7ant la clau privada associada.</li> <li>Les claus privades permeten signar un missatge per tal que el receptor verifiqui la identitat de l\u2019emissor. La comprovaci\u00f3 de la signatura es far\u00e0 mitjan\u00e7ant la clau p\u00fablica associada.</li> </ul> <p>En una comunicaci\u00f3 t\u00edpica tindrem els passos que es mostren a continuaci\u00f3 i que podeu veure de manera gr\u00e0fica en la figura:</p> <p> <pre><code>sequenceDiagram\n    autonumber\n    participant Emissor\n    participant Receptor\n\n    Emissor-&gt;&gt;Receptor: Genera clau p\u00fablica i clau privada\n    Receptor--&gt;&gt;Emissor: Envia la clau p\u00fablica al remitent\n    Emissor-&gt;&gt;Emissor: Xifra el missatge amb la clau p\u00fablica del receptor\n    Emissor-&gt;&gt;Receptor: Envia el missatge xifrat\n    Receptor-&gt;&gt;Receptor: Desxifra el missatge amb la seva clau privada\n    Receptor--&gt;&gt;Emissor: Llegeix el missatge desxifrat</code></pre> </p> <p>Aquest diagrama il\u00b7lustra el proc\u00e9s pas a pas del xifratge en clau p\u00fablica:</p> <ol> <li>El receptor genera una parella de claus: una clau p\u00fablica i una clau privada.</li> <li>El receptor envia la clau p\u00fablica a l'emissor.</li> <li>L'emissor utilitza la clau p\u00fablica per xifrar el missatge.</li> <li>L'emissor envia el missatge xifrat al receptor.</li> <li>El receptor desxifra el missatge amb la seva clau privada.</li> <li>Finalment, el receptor pot llegir el missatge en text clar.</li> </ol> <p>Aquest proc\u00e9s garanteix la confidencialitat del missatge, ja que nom\u00e9s el receptor pot desxifrar-lo amb la seva clau privada.</p> <p>En aquest procediment mai no es transmeten les claus privades. L\u2019intercanvi de les claus p\u00fabliques \u00e9s senzill, ja que no cal que es transmetin fent \u00fas d\u2019un canal segur. Es garanteix que el missatge no pot ser comprom\u00e8s en la seva transmissi\u00f3 i tant l\u2019emissor com el receptor comproven l\u2019autenticitat de l\u2019altra entitat.</p> <p>El principal inconvenient de la criptografia de clau p\u00fablica \u00e9s el seu consum de recursos. \u00c9s m\u00e9s costosa en temps d\u2019encriptaci\u00f3/desencriptaci\u00f3 i el missatge encriptat ocupa m\u00e9s que el text clar. En la taula seg\u00fcent podeu veure un resum dels principals avantatges i inconvenients de les diferents t\u00e8cniques criptogr\u00e0fiques.</p>"},{"location":"SMX2-SXA-2/#criptografia-hibrida","title":"Criptografia h\u00edbrida","text":"<p>La criptografia h\u00edbrida combina el sistema de clau compartida i el de clau p\u00fablica per obtenir tots els avantatges sense els inconvenients. En aquest sistema nom\u00e9s s\u2019utilitza la criptografia de clau p\u00fablica per transmetre una clau compartida, normalment generada de manera din\u00e0mica per aquesta comunicaci\u00f3, al receptor. Una vegada s\u2019ha comunicat la clau compartida a totes dues estacions, s\u2019utilitza l\u2019encriptaci\u00f3 convencional per tal d\u2019encriptar el gruix del missatge.</p> <p>Els sistemes basats en criptografia h\u00edbrida s\u00f3n tan forts com els sistemes de clau compartida i clau p\u00fablica que utilitzin.</p> T\u00e8cnica criptogr\u00e0fica Avantatges Inconvenients Criptografia clau compartida. Consumeix pocs recursos. S\u2019encripta/desencripta amb gran velocitat L\u2019intercanvi de claus necessita un canal segur Criptografia clau p\u00fablica. No necessita un canal segur per intercanviar les claus. Consumeix recursos. El proc\u00e9s d\u2019encriptaci\u00f3/desencriptaci\u00f3 \u00e9s lent Criptografia h\u00edbrida. S\u2019encripta/desencripta amb gran velocitat."},{"location":"SMX2-SXA-2/#secure-shell-ssh","title":"Secure SHell (SSH)","text":"<p>SSH \u00e9s un protocol de xarxa que permet l\u2019intercanvi d\u2019informaci\u00f3 de manera segura. Utilitza encriptaci\u00f3 i criptografia de clau p\u00fablica per tal de fer l\u2019autenticaci\u00f3 de l\u2019estaci\u00f3 remota.</p> <p>Una de les funcions m\u00e9s emprades \u00e9s iniciar una sessi\u00f3 remota per tal d\u2019executar ordres. Per\u00f2 les seves capacitats s\u00f3n m\u00e9s \u00e0mplies, ja que tamb\u00e9 permet:</p> <ul> <li>Transmetre fitxers de manera segura.</li> <li>Fer t\u00fanels per assegurar qualsevol servei que no es transmeti encriptat (HTTP, SMTP, VNC, etc.) o per travessar tallafocs que estiguin bloquejant el protocol.</li> <li>Reenviament autom\u00e0tic de sessions X11.</li> <li>Fins i tot, en fer servir SSHFS, actuar com a sistema de fitxers en xarxa.</li> </ul> <p>Les seves possibilitats es poden combinar de moltes maneres diferents. Donades les seves capacitats criptogr\u00e0fiques, SSH \u00e9s una eina fonamental per a l\u2019administrador de xarxa.</p>"},{"location":"SMX2-SXA-2/#com-funciona-lencriptacio-en-ssh","title":"Com funciona l'encriptaci\u00f3 en SSH","text":"<p>El protocol SSH empra un model client-servidor per autenticar les dues parts i xifrar les dades entre ells.</p> <p>El servidor escolta en un port designat per a les connexions. \u00c9s responsable de la negociaci\u00f3 de la connexi\u00f3 segura, l'autenticaci\u00f3, i preparar l'entorn si s'accepten les credencials.</p> <p>El client \u00e9s responsable de comen\u00e7ar la connexi\u00f3 inicial de TCP amb el servidor, de negociar de la connexi\u00f3 segura, de verificar que la identitat del servidor coincideix amb la informaci\u00f3 pr\u00e8viament gravada, i de proporcionar credencials per autenticar-se.</p> <p>Una sessi\u00f3 SSH s'estableix en dues etapes separades. La primera \u00e9s la d'aprovar i establir el xifrat per a protegir les comunicacions futures. La segona etapa \u00e9s per autenticar a l'usuari.</p>"},{"location":"SMX2-SXA-2/#la-negociacio-del-xifrat-per-a-la-sessio-ssh","title":"La negociaci\u00f3 del xifrat  per a la sessi\u00f3 SSH","text":"<p>Quan un client es connecta, el servidor respon amb les versions de protocol que suporta. Si el client accepta alguna de les versions de protocol suportades, la connexi\u00f3 continua. El servidor tamb\u00e9 proporciona la seva clau p\u00fablica, que el client pot utilitzar per comprovar si el servidor \u00e9s realment el que diu ser. En aquest punt, les dues parts negocien una clau de sessi\u00f3.</p> <p>La clau de sessi\u00f3 (sim\u00e8trica) ser\u00e0 utilitzada per xifrar tota la sessi\u00f3. Els parells de claus p\u00fabliques i privades que s'utilitzen en aquesta negociaci\u00f3 s\u00f3n totalment independents de les claus SSH utilitzades per autenticar un client al servidor. Aquestes claus p\u00fabliques s'usaran per a compartir la clau de sessi\u00f3 creada i per a xifrar totes de les comunicacions que es duguen a terme durant la sessi\u00f3.</p> <p> <pre><code>sequenceDiagram\n    participant Client\n    participant Servidor\n\n    Client-&gt;&gt;Servidor: El Client inicia la connexi\u00f3\n    Servidor--&gt;Client: Servidor i Client negocien la versi\u00f3 del protocol i l'agoritme de xifrat (sim\u00e8tric)\n    Servidor-&gt;&gt;Client: El Servidor envia la seua clau p\u00fablica\n    Client-&gt;&gt;Client: Comprovaci\u00f3 de la identitat del servidor (clau p\u00fablica)\n    Client-&gt;&gt;Servidor: El client genera una clau de sessi\u00f3 (sim\u00e8trica) que ser\u00e0 encriptada amb la clau p\u00fablica del servidor (asim\u00e8trica)\n    Servidor--&gt;Client: La clau de sessi\u00f3 i l'algoritme seleccionat s'usaran per a encriptar l'intercanvi de dades</code></pre> </p>"},{"location":"SMX2-SXA-2/#metodes-dautenticacio-del-servei-ssh","title":"M\u00e8todes d'autenticaci\u00f3 del servei SSH","text":"<p>L\u2019autenticaci\u00f3 \u00e9s l\u2019acci\u00f3 de comprovar la identitat del remitent en una comunicaci\u00f3. El servidor SSH, en rebre una sol\u00b7licitud de connexi\u00f3 nova, necessita autenticar l\u2019origen d\u2019aquesta connexi\u00f3 com a pas previ per autoritzar o denegar la connexi\u00f3.</p> <p>El servidor SSH pot emprar  diversos mecanismes diferents d\u2019autenticaci\u00f3. Entre aquests mecanismes destaquem, per ordre de prefer\u00e8ncia:</p> <ol> <li>Autenticaci\u00f3 basada en l\u2019amfitri\u00f3</li> <li>Autenticaci\u00f3 de clau p\u00fablica</li> <li>Autenticaci\u00f3 desafiament-resposta</li> <li>Autenticaci\u00f3 basada en la contrasenya</li> </ol> <p>\u00c9s molt important aclarir que abans de l\u2019autenticaci\u00f3, tant a SSH1 com a SSH2, s\u2019establir\u00e0 una comunicaci\u00f3 encriptada entre el client i el servidor. Per establir aquesta connexi\u00f3 encriptada es fan servir t\u00e8cniques criptogr\u00e0fiques de clau p\u00fablica. Una vegada acordada una clau comuna s\u2019utilitzar\u00e0 una encriptaci\u00f3 sim\u00e8trica per a la resta de la sessi\u00f3.</p>"},{"location":"SMX2-SXA-2/#autenticacio-basada-en-lamfitrio","title":"Autenticaci\u00f3 basada en l'amfitri\u00f3","text":"<p>Aquesta \u00e9s la t\u00e8cnica m\u00e9s segura, impedeix els atacs basats en la suplantaci\u00f3 d\u2019adreces IP, de DNS i de la taula de rutes.</p> <p>SSH genera una parella de claus, p\u00fablica i privada, durant la seva instal\u00b7laci\u00f3 en cada equip. Aquestes claus identifiquen l\u2019estaci\u00f3 en qu\u00e8 s\u2019executa SSH, no els seus usuaris. S\u00f3n les anomenades claus d\u2019amfitri\u00f3 (host) i, si el compte de superusuari (root) no est\u00e0 comprom\u00e8s (\u00e9s a dir, si ning\u00fa no s\u2019ha convertit en superusuari de manera fraudulenta), no \u00e9s necessari canviar-les.</p> <p>SSH2 pot emprar els algorismes RSA i DSA, mentre que SSH1 nom\u00e9s pot fer servir RSA.</p> <p>Per tal de que l\u2019autenticaci\u00f3 basada en l\u2019amfitri\u00f3 permeti a l\u2019usuari iniciar sessi\u00f3 mitjan\u00e7ant SSH, cal:</p> <ol> <li>Que el servidor pugui verificar la clau d\u2019amfitri\u00f3 del client. Aquesta verificaci\u00f3 es produeix si el servidor registra en el fitxer <code>known_hosts</code> la clau d\u2019amfitri\u00f3 p\u00fablica del client. (Aquest fitxer es troba a <code>/etc/SSH/SSH_known_hosts</code> per a tot el sistema o b\u00e9 a <code>.SSH/known_hosts</code> per a cada usuari).</li> <li>Que la m\u00e0quina que inicia la connexi\u00f3 estigui llistada en el fitxer <code>/etc/SSH/shosts.equiv</code> (o la seva versi\u00f3 insegura <code>/etc/hosts.equiv</code>) i el nom d\u2019usuari en l\u2019estaci\u00f3 client i en el servidor sigui el mateix. O b\u00e9 que en servidor, en el directori de l\u2019usuari que intenta iniciar sessi\u00f3, hi hagi el fitxer <code>.shosts</code> (o la seva versi\u00f3 insegura <code>.rhosts</code>), en qu\u00e8 apareguin la m\u00e0quina client i el nom d\u2019usuari en aquella estaci\u00f3.</li> </ol>"},{"location":"SMX2-SXA-2/#autenticacio-de-clau-publica","title":"Autenticaci\u00f3 de clau p\u00fablica","text":"<p>Aquest sistema es basa, com el seu nom indica, en t\u00e8cniques criptogr\u00e0fiques de clau p\u00fablica en qu\u00e8 el que s'encripta mitjan\u00e7ant la clau p\u00fablica nom\u00e9s es pot desencriptar mitjan\u00e7ant la clau privada associada, i en qu\u00e8 la clau privada es pot emprar per signar els missatges per tal que el receptor pugui autenticar l'emissor.</p> <p>Cal que l'usuari que vol iniciar una sessi\u00f3 remota al servidor constru\u00efsca una parella de claus, normalment fent \u00fas de l'eina <code>SSH-keygen</code>. Aquestes claus s'emmagatzemaran en el directori <code>/.SSH/</code> (en els fitxers <code>id_rsa/id_rsa.pub, id_dsa/id_dsa.pub</code> per a SSH2 o b\u00e9 <code>identity/identity.pub</code> per a SSH1).</p> <p>En construir la parella de claus, l\u2019eina <code>SSH-keygen</code> ens permetr\u00e0 definir si volem emprar una clau RSA o DSA. Tamb\u00e9 ser\u00e0 possible protegir les claus mitjan\u00e7ant un mot de pas que ser\u00e0 necessari escriure per desbloquejar la clau i poder emprar-la. De fet, aquesta \u00e9s una opci\u00f3 molt recomanable; nom\u00e9s es deixaran claus sense protegir si es tracta de les claus d'amfitri\u00f3 o b\u00e9 si es vol iniciar sessi\u00f3 de manera automatitzada (mitjan\u00e7ant scripts) sense que sigui necess\u00e0ria la intervenci\u00f3 de l'usuari per desbloquejar les claus.</p> <p>Una vegada s'han generat les claus ser\u00e0 necessari transportar la clau p\u00fablica a l'estaci\u00f3 en qu\u00e8 es vol iniciar sessi\u00f3 i afegir-la al fitxer <code>.SSH/authorized_keys</code> de l'usuari corresponent.</p> <p>A partir d'aquest moment l'usuari podr\u00e0 iniciar una sessi\u00f3 SSH sense haver d'especificar la seva contrasenya. Per\u00f2 si ha especificat una frase de pas per bloquejar les claus, encara ser\u00e0 necessari introduir-la per poder fer servir les claus.</p> <p>RSA i DSA</p> <p>S\u00f3n dos algorismes que fan servir l\u2019encriptaci\u00f3 de clau p\u00fablica.RSA s\u00f3n les inicials dels investigadors que van desenvolupar l\u2019algorisme: Ron Rivest, Adi Shamir i Leonard Adleman.DSA s\u00f3n les sigles dedigital signature algorithm, \u00e9s a dir, algoritme de signatura digital.</p> <p>Fitxer <code>known_hosts</code></p> <p>Quan un client SSH estableix una connexi\u00f3 per primera vegada amb un amfitri\u00f3, enregistra en fitxer known_hosts la clau p\u00fablica de l\u2019estaci\u00f3. La propera vegada que s\u2019estableixi una connexi\u00f3 es comprovar\u00e0 aquesta clau p\u00fablica.</p> PR\u00c0CTICA 2: Connexi\u00f3 SSH i transfer\u00e8ncia d'arxius <p>L'objectiu d'aquesta pr\u00e0ctica \u00e9s aprendre a:</p> <ul> <li>Configurar SSH en un Ubuntu Server.</li> <li>Comunicar-se per SSH amb la m\u00e0quina Ubuntu Server.</li> <li>Utilitzar PuTTY en Windows per establir una connexi\u00f3 SSH al servidor Ubuntu.</li> <li>Instal\u00b7lar i utilitzar FileZilla en Windows per a realitzar transfer\u00e8ncies SFTP entre client (Windows 11) i servidor (Ubuntu Server 24).</li> </ul> <p>Seguiu les instruccions seg\u00fcents per fer l'activitat.</p> <ol> <li> <p>Instal\u00b7leu el programa servidor SSH: <code>openssh-server</code> en el Ubuntu Server. Creeu tamb\u00e9 un usuari <code>remote_user</code> al servidor.</p> </li> <li> <p>Comproveu el funcionament dels serveis.</p> </li> <li> <p>Instal\u00b7leu els programaes PuTTY i FileZilla en el Client Windows. Descarregueu tamb\u00e9 una imatge jpg.</p> </li> <li> <p>Des del client Windows connecteu per SSH al Server (usuari <code>remote_user</code>) i creeu un fitxer de &gt; 4MB anomenat <code>fitxer_server_nomAlumne</code></p> </li> <li> <p>Des del client Windows connecteu amb FileZilla al Server (usuari <code>remote_user</code>) i intercanvieu els fitxers: al server estar\u00e0 la imatge descarregada i al client estar\u00e0 el fitxer del servidor.</p> </li> </ol> <p>Documenta el proc\u00e9s amb captures i comentaris.</p>"},{"location":"SMX2-SXA-2/#tansferencia-segura-darxius-scp","title":"Tansfer\u00e8ncia segura d'arxius - scp","text":"<p>Funciona d'igual forma que la comanda <code>cp</code> que s'empra per copiar en local, per\u00f2 de forma remota. La sintaxi b\u00e0sica del comandament <code>scp</code> \u00e9s la seg\u00fcent:</p> scp (Secure Copy)<pre><code>scp [opcions] [usuari@]host:fitxer_origen [usuari@]host:fitxer_dest\u00ed\n</code></pre> Exemples d'\u00fas <p>Copiar un fitxer des de la m\u00e0quina local a una m\u00e0quina remota:</p> Bash<pre><code>scp fitxer_local.txt usuari@host_remot:/ruta/dest\u00ed/\n</code></pre> <p>Copiar un fitxer des d'una m\u00e0quina remota a la m\u00e0quina local:</p> Bash<pre><code>scp usuari@host_remot:/ruta/origen/fitxer_remot.txt /ruta/dest\u00ed/\n</code></pre> <p>Copiar un directori de manera recursiva des de la m\u00e0quina local a una m\u00e0quina remota:</p> Bash<pre><code>scp -r directori_local/ usuari@host_remot:/ruta/dest\u00ed/\n</code></pre> <p>Copiar un fitxer entre dues m\u00e0quines remotes:</p> Bash<pre><code>scp usuari1@host_remot1:/ruta/origen/fitxer.txt usuari2@host_remot2:/ruta/dest\u00ed/\n</code></pre> <p>Copiar un fitxer especificant un port SSH diferent:</p> Bash<pre><code>scp -P 2222 fitxer_local.txt usuari@host_remot:/ruta/dest\u00ed/\n</code></pre> <p>Copiar un fitxer amb compressi\u00f3 durant la transfer\u00e8ncia:</p> Bash<pre><code>scp -C fitxer_local.txt usuari@host_remot:/ruta/dest\u00ed/\n</code></pre> <p>Copiar un fitxer amb una velocitat de transfer\u00e8ncia limitada:</p> Bash<pre><code>scp -l 1000 fitxer_local.txt usuari@host_remot:/ruta/dest\u00ed/\n</code></pre> ACTIVITAT 3: Copia remota amb scp <p>Tota l'activitat s'ha de fer des d'un client Lubuntu, loguejat com a <code>remote_user</code>. El Server DHCP ha d'estar en marxa, per\u00f2 no es pot accedir a ell. Fes el seg\u00fcent:</p> <ol> <li>Crea les carpetes ENVIAR i REBRE a l'escriptori del client (Recorda, usuari <code>remote_user</code>).</li> <li>Crea a la carpeta ENVIAR del client els fitxers <code>exemple.txt</code>, <code>examen.txt</code>, <code>document.pdf</code> i <code>exercici.pdf</code>. Aquests fitxers no han de tindre m\u00e9s de 10MB. Pots fer \u00fas de la comanda <code>fallocate</code>. Crea tamb\u00e9 un fitxer anomenat <code>mitja</code> de 50MB de tamany i altre fitxer <code>gran</code> de 200MB de tamany.</li> <li>Crea la carpeta REPOS al directori <code>/home/remote_user</code> del servidor.</li> <li>Crea els fitxers <code>server1.txt</code> i <code>server2.txt</code> dins de la carpeta REPOS.</li> <li>Copia els fitxers, d'un en un, amb scp entre el client i el servidor: de la carpeta ENVIAR a REPOS i de REPOS a REBRE.</li> </ol> <p>Documenta tot el proc\u00e9s.</p>"},{"location":"SMX2-SXA-2/#sincronitzacio-de-directoris-amb-rsync","title":"Sincronitzaci\u00f3 de directoris amb rsync","text":"<p>La comanda <code>rsync</code> \u00e9s una eina poderosa per a la sincronitzaci\u00f3 de fitxers i directoris entre diferents ubicacions, ja siga en la mateixa m\u00e0quina o entre m\u00e0quines remotes. La seva sintaxi b\u00e0sica \u00e9s la seg\u00fcent:</p> Bash<pre><code>rsync [opcions] [origen] [dest\u00ed]\n</code></pre> <p>Opcions comunes</p> <ul> <li><code>-a</code> o <code>--archive</code>: Mode arxiu; \u00e9s equivalent a <code>-rlptgoD</code> (recursiu, enlla\u00e7os, permisos, temps, grup, propietari, dispositius).</li> <li><code>-v</code> o <code>--verbose</code>: Mostra informaci\u00f3 detallada del proc\u00e9s.</li> <li><code>-z</code> o <code>--compress</code>: Comprimeix els fitxers durant la transfer\u00e8ncia.</li> <li><code>-P</code>: Mostra el progr\u00e9s de la transfer\u00e8ncia i permet reprendre transfer\u00e8ncies interrompudes.</li> <li><code>--delete</code>: Elimina els fitxers del dest\u00ed que no existeixen en l'origen.</li> <li><code>-e ssh</code>: Utilitza SSH per a la transfer\u00e8ncia de dades.</li> </ul> Exemples d'\u00fas <p>Sincronitzar un directori local amb un altre directori local:</p> Bash<pre><code>rsync -av /ruta/origen/ /ruta/desti/\n</code></pre> <p>Sincronitzar un directori local amb un directori remot:</p> Bash<pre><code>rsync -av -e ssh /ruta/origen/ usuari@host_remot:/ruta/desti/\n</code></pre> <p>Sincronitzar un directori remot amb un directori local:</p> Bash<pre><code>rsync -av -e ssh usuari@host_remot:/ruta/origen/ /ruta/desti/\n</code></pre> <p>Sincronitzar un directori local amb un directori remot i eliminar fitxers que no existeixen en l'origen:</p> Bash<pre><code>rsync -av --delete -e ssh /ruta/origen/ usuari@host_remot:/ruta/desti/\n</code></pre> <p>Sincronitzar un directori local amb un directori remot amb compressi\u00f3:</p> Bash<pre><code>rsync -avz -e ssh /ruta/origen/ usuari@host_remot:/ruta/desti/\n</code></pre> <p>Sincronitzar un directori local amb un directori remot mostrant el progr\u00e9s:</p> Bash<pre><code>rsync -avP -e ssh /ruta/origen/ usuari@host_remot:/ruta/desti/\n</code></pre> ACTIVITAT 4: Sincronitzaci\u00f3 amb rsync <p>L'objectiu d'aquesta pr\u00e0ctica \u00e9s aprendre a utilitzar <code>rsync</code> per sincronitzar fitxers i directoris entre un client i un servidor.</p> <p>Seguiu les instruccions seg\u00fcents per fer l'activitat.</p> <ol> <li>Creeu un directori <code>sync_origen</code> al client i afegiu alguns fitxers de text.</li> <li>Creeu un directori <code>sync_desti</code> al servidor.</li> <li>Utilitzeu <code>rsync</code> per sincronitzar el directori <code>sync_origen</code> del client amb el directori <code>sync_desti</code> del servidor.</li> <li>Afegiu nous fitxers al directori <code>sync_origen</code> i torneu a executar <code>rsync</code> per veure com es sincronitzen els canvis.</li> </ol> <p>Documenta el proc\u00e9s amb captures i comentaris.</p>"},{"location":"SMX2-SXA-4/","title":"UD4. El servei DNS","text":""},{"location":"SMX2-SXA-4/#-","title":"---","text":"<p>subtitle: 2SMX - SXA--- lang: catamb\u00e9 un altre tipus de servidors, els servidors DNS cach\u00e9 (cau). Els servidors DNS cach\u00e9 sols atenen consultes dels clients DNS sobre noms de domini. No cont\u00e9 cap informaci\u00f3 sobre la zona i la seua utilitat principal \u00e9s accelerar les consultes.</p>"},{"location":"SMX2-SXA-4/#resolucio-de-noms","title":"Resoluci\u00f3 de noms","text":"<p>Tot sovint en les aplicacions d'usuari i de sistema s'accedeix a recursos pel seu nom de domini. Per exemple, un client web requereix una determinada p\u00e0gina web, un navegador de fitxers vol accedir a unes carpetes d'una m\u00e0quina remota que s'identifiquen pel nom de domini, el sistema ha de validar l'usuari contra un servidor LDAP remot, etc. En cada un d'aquests casos caldr\u00e0 resoldre una pregunta del tipus aquest domini a quina adre\u00e7a IP correspon? Aquesta pregunta no la responen les aplicacions individualment (el navegador web, el client d'autenticaci\u00f3...), sin\u00f3 que utilitzen el resolver per fer-ho.</p> <p>El resolver \u00e9s la part client de l'arquitectura client-servidor del DNS. Ell ha d'atendre les necessitats de les aplicacions, confeccionar una consulta o query, fer-la a un servidor DNS, obtenir la resposta i passar-la a l'aplicaci\u00f3 pertinent.</p> <p>LA RESOLUCI\u00d3</p> <p>El mecanisme de resoluci\u00f3 de noms DNS consta d'un client o resolver que realitzar\u00e0 les consultes (o querys) a resoldre a uns servidors DNS.</p> <p>Si el servidor disposa de la informaci\u00f3 perqu\u00e8 forma part de la base de dades de la seva zona, emetr\u00e0 una resposta autoritativa. Si disposa de la resposta perqu\u00e8 la t\u00e9 emmagatzemada temporalment (en un proc\u00e9s anomenat cache) tamb\u00e9 emetr\u00e0 la resposta per\u00f2 aquest cop de manera no autoritativa. Si no t\u00e9 informaci\u00f3 del domini buscat, el servidor pot fer a altres servidors la mateixa consulta en un proc\u00e9s que pot ser recursiu o iteratiu. Sempre existeix un cam\u00ed per trobar el domini buscat, que \u00e9s preguntar als nodes arrel (root servers) de l'espai de noms de domini. Partint dels nodes arrel i recorrent l'arbre cap avall, es pot arribar al domini buscat, si \u00e9s que existeix.</p> <p>Sempre hi ha un cam\u00ed a un domini existent partint del node arrel. Quan un servidor \u00e9s consultat sobre un domini que desconeix (no \u00e9s de la seva zona ni t\u00e9 la resposta en la cache) pot escalar la pregunta a un servidor de l'arrel (root name server). Aix\u00f2 significa que els servidors arrel s\u00f3n crucials per al funcionament del DNS.</p> Consulta iterativa <p>Mitjan\u00e7ant l'eina de consulta DNS <code>dig</code> amb les opcions <code>@servidordns</code> i <code>+trace</code> realitza la consulta del domini wikipedia.org substituint <code>servidordns</code> per 3 servidors diferents (8.8.8.8, 1.1.1.1, Servidor DNS local).</p> <p>Determina la seq\u00fc\u00e8ncia de les consultes realitzades en els tres casos i compara-les.</p> <p>Sempre consulta els mateixos servidors? Per qu\u00e8? Quina ha estat m\u00e9s r\u00e0pida? Justifica les respostes.</p>"},{"location":"SMX2-SXA-4/#servidors-arrel","title":"Servidors arrel","text":"<p>Un servidor arrel de noms \u00e9s un servidor de noms que respon directament les peticions de registres de la zona arrel i respon altres consultes tornant una llista de servidors acreditats de noms del domini de primer nivell adient (TLD). Els servidors arrel de noms s\u00f3n una part cr\u00edtica de la infraestructura de l'Internet, ja que s\u00f3n el primer pas en la traducci\u00f3 (resoluci\u00f3) dels noms de servidors entenedors pels humans en adreces IP que s'utilitzen entre amfitrions d'Internet.</p> <p>Actualment disposem de 13 servidors arrels.</p> <p>Consulta servidors arrel</p> <p>L'execuci\u00f3 del comandament <code>dig</code> sense par\u00e0metres ens torna la llista completa de servidors arrel.</p>"},{"location":"SMX2-SXA-4/#el-protocol-dns","title":"El protocol DNS","text":"<p>El servei de noms de domini utilitza el protocol DNS per fer les consultes i les respostes. Es tracta d'un protocol de capa d'aplicaci\u00f3 que pot utilitzar tant UDP com TCP en la capa de transport. Usualment, tant les consultes del client com les respostes del servidor es poden encabir en un datagrama (512 bytes) i s'utilitza UDP (de fet, generalment es diu que el DNS usa UDP). Per\u00f2 si la informaci\u00f3 a transmetre \u00e9s \u00e0mplia (per exemple, una resposta amb una llista amb molta informaci\u00f3), la comunicaci\u00f3 es passa a TCP autom\u00e0ticament. Un altre cas en qu\u00e8 la informaci\u00f3 \u00e9s TCP \u00e9s quan es realitza la transfer\u00e8ncia d'informaci\u00f3 d'una zona entre servidors primaris i secundaris. El servidor DNS utilitza el port privilegiat 53.</p> <p>El protocol DNS \u00e9s usualment UDP, per\u00f2 pot ser TCP i UDP. Es tracta d'un protocol de capa d'aplicaci\u00f3 i utilitza el port 53.</p> <p>La comunicaci\u00f3 DNS \u00e9s un mecanisme de consulta/resposta entre el client i el servidor. Els datagrames, doncs, seran de query (consulta) o answer (resposta).</p> <p>Els apartats que componen un missatge DNS s\u00f3n:</p> <ul> <li>HEADER. Cap\u00e7alera del missatge indicant si \u00e9s una consulta o una resposta. Cont\u00e9 l'id (identificador) del missatge, flags i un resum de quines seccions del missatge porten informaci\u00f3 i quanta.</li> <li>QUESTION. Aquesta secci\u00f3 cont\u00e9 la consulta que s'ha efectuat. \u00c9s a dir, quina dada s'ha demanat al servidor. Pot ser una resoluci\u00f3 d'adre\u00e7a IP a un domini, demanar la llista de servidors d'impressi\u00f3, etc.</li> <li>ANSWER. Secci\u00f3 que cont\u00e9 la resposta obtinguda del servidor. S'ent\u00e9n que aquesta secci\u00f3 cont\u00e9 la resposta no autoritativa. A vegades en les utilitats de consulta aquesta secci\u00f3 es mostra com a non-autority answer.</li> <li>AUTHORITY. Aquesta secci\u00f3 cont\u00e9 les respostes que s\u00f3n autoritatives per a la consulta efectuada. Evidentment pot ser buida.</li> <li>ADDITIONAL. Cont\u00e9 informaci\u00f3 addicional per completar la resposta. En l'exemple s'observa que completa la resoluci\u00f3 dels noms de m\u00e0quina que hi ha a la secci\u00f3 answer tot indicant la seva adre\u00e7a IP corresponent.</li> </ul>"},{"location":"SMX2-SXA-4/#tipus-de-registres","title":"Tipus de registres","text":"<p>El sistema de noms de domini \u00e9s una base de dades jer\u00e0rquica i distribu\u00efda en qu\u00e8 cada servidor de noms gestiona la informaci\u00f3 corresponent a la zona de la qual \u00e9s autoritari. Cada zona cont\u00e9 informaci\u00f3 dels hosts que la formen. La informaci\u00f3 de zona s'emmagatzema en forma de registre de recurs o resource record (RR). Hi ha la informaci\u00f3 que permet identificar cada nom de domini amb l'adre\u00e7a IP corresponent, anomenat forward mapping o resoluci\u00f3 directa. Tamb\u00e9 cont\u00e9 la informaci\u00f3 per identificar cada adre\u00e7a IP amb el nom de domini corresponent, anomenat reverse mapping o resoluci\u00f3 inversa. La informaci\u00f3 de zones cont\u00e9 altres informacions que permeten identificar els servidors DNS autoritaris per la zona, els servidors de correu, etc.</p>"},{"location":"SMX2-SXA-4/#base-de-dades-de-zona","title":"Base de dades de zona","text":"<p>La configuraci\u00f3 d'una zona s'emmagatzema en un conjunt de fitxers anomenat fitxers de zona. L'especificaci\u00f3 del DNS diu com han de ser aquests fitxers de zona i com s'hi han de descriure els registres de recurs (descripci\u00f3 de cada element que pertany a la zona).</p>"},{"location":"SMX2-SXA-4/#registre-soa","title":"Registre SOA","text":"<p>El registre de recurs SOA o start of authority (inici de definici\u00f3 de zona amb autoritat) diu que el fitxer de zona on es troba \u00e9s la millor font de dades per a la zona, que el servidor de noms \u00e9s autoritari per a la zona. Acostuma a ser el primer RR que hi ha en el fitxer de zona, tot i que no \u00e9s obligatori. Per cada fitxer de zona hi ha d'haver nom\u00e9s un registre SOA.</p>"},{"location":"SMX2-SXA-4/#registre-ns","title":"Registre NS","text":"<p>El registre de recurs NS o name server (servidor de noms) defineix un servidor de noms autoritatiu per a la zona. Hi haur\u00e0 tantes entrades NS com servidors de noms autoritatius hi ha en la zona. L'est\u00e0ndard DNS en recomana almenys dos (un de primari o master i un de seguretat secundari o slave).</p>"},{"location":"SMX2-SXA-4/#registre-a-o-aaa","title":"Registre A o AAA","text":"<p>Un registre de recurs A o address (adre\u00e7a) associa un nom de host a una adre\u00e7a IP (resoluci\u00f3 directa). Per cada nom de host de la xarxa caldr\u00e0 disposar d'una entrada on s'associ\u00ef el nom del host a la seva adre\u00e7a IP.</p>"},{"location":"SMX2-SXA-4/#registre-cname","title":"Registre CNAME","text":"<p>Els registres de recurs CNAME o canonical name (nom can\u00f2nic) associen un \u00e0lies a un nom can\u00f2nic.</p>"},{"location":"SMX2-SXA-4/#altres-registres","title":"Altres registres","text":""},{"location":"SMX2-SXA-4/#registre-mx","title":"Registre MX","text":"<p>Un registre MX mail echanger (servidor de correu electr\u00f2nic) defineix un servidor de correu. Es pot posar una entrada MX per a cada servidor de correu, per\u00f2 no \u00e9s obligatori que n'hi hagi cap.</p>"},{"location":"SMX2-SXA-4/#resgistre-ptr","title":"Resgistre PTR","text":"<p>Un registre de recurs PTR o pointer (punter) associa una adre\u00e7a IP al nom de host pertinent (resoluci\u00f3 inversa). Cal una entrada PTR per a cada interf\u00edcie de xarxa de la zona.</p>"},{"location":"SMX2-SXA-4/#altres","title":"Altres","text":"<p>Hi ha altres tipus de registres de recurs que no s\u00f3n tan utilitzats i que es mencionen a continuaci\u00f3:</p> <ul> <li>HINFO: (Host Information) informaci\u00f3 sobre el tipus d'ordinador.</li> <li>MB: (Mail Box) informaci\u00f3 sobre una b\u00fastia de correu.</li> <li>MG: (Mailgroup) informaci\u00f3 sobre un grup de correu.</li> <li>MR: nom nou d'una b\u00fastia de correu.</li> <li>WKS (Well Known Services) llista de serveis del host.</li> <li>TXT: (Text) text descriptiu.</li> <li>NULL: (Null) registre buit.</li> <li>AAAA () corresponent a una adre\u00e7a de host usant Ipv6.</li> </ul>"},{"location":"SMX2-SXA-4/#evolucio-del-protocol-i-seguretat","title":"Evoluci\u00f3 del protocol i seguretat","text":"<p>Els protocols DNS han evolucionat molt gr\u00e0cies a les noves necessitats provocades per l'increment exponencial de les xarxes. Una de les principals vies en evoluci\u00f3 \u00e9s el DDNS o din\u00e0mic DNS i el DNSSEC o DNS segur.</p> <p>DDNS</p> <p>El protocol DDNS (dynamic DNS) permet que les dades del servidor DNS s'actualitzin en temps real. El principal \u00fas \u00e9s permetre que clients amb adreces IP din\u00e0miques d'interval puguin disposar d'un nom de domini (a pesar que la seva adre\u00e7a IP varia d'una sessi\u00f3 a una altra). Un mecanisme consisteix a permetre que els servidors DHCP es comuniquin amb els servidors DNS i els notifiquin les actualitzacions a la base de dades de DNS que cal fer. En funci\u00f3 de les configuracions de xarxa que els servidors DHCP proporcionen als seus clients es fan les actualitzacions al DNS.</p> <p>DNSSEC</p> <p>Man in the middle</p> <p>S'anomena man-in-the-middle aquells equips que es fan passar per altres en una connexi\u00f3 de xarxa. El client creu connectar amb el seu banc, per\u00f2 de fet est\u00e0 connectant amb un \"atacant\" situat entremig. Aquest atacant rep el tr\u00e0nsit del client i el transfereix al banc, rep la resposta del banc i la passa al client. En aquest proc\u00e9s est\u00e0 en disposici\u00f3 de \"manipular\" tot aquest tr\u00e0nsit a la seva conveni\u00e8ncia.</p> <p>DNSSEC o Domain Name System Security Extensions (extensions de seguretat per a DNS) s\u00f3n un conjunt d'especificacions de seguretat per permetre una comunicaci\u00f3 DNS segura, de manera que el client pugui estar plenament segur que qui li respon les consultes \u00e9s el seu servidor DNS i no un impostar (el man-in-the-middle). Tamb\u00e9 garanteix la integritat de les dades tant de les consultes com de les respostes i a m\u00e9s a m\u00e9s est\u00e0 dissenyat per prevenir atacs de denegaci\u00f3 de servei.</p> <p>Servidors DNS enverinats</p> <p>Un dels principals problemes del protocol DNS (com de tots els primers protocols d'Internet) \u00e9s la falta de seguretat. Va ser dissenyat en una \u00e8poca de 'bon rotllo' on es confiava amb els altres integrants de la xarxa. Aix\u00f2 avui en dia no \u00e9s massa sensat.</p> <p>Imagineu que un atacant aconsegueix el control d'un servidor DNS o aconsegueix fer passar el seu servidor DNS fals com a servidor d'un conjunt d'usuaris. Cada vegada que aquests clients fan una consulta a Internet, per exemple al seu banc (posant el nom de la web), el servidor DNS enverinat proporciona una adre\u00e7a IP no del banc real sin\u00f3 d'una web falsa amb la finalitat de...</p> <p>Cada cop que accedim a una web, un servei, un host, etc. per mitj\u00e0 del seu nom de domini, confiem que el servidor DNS proporcioni l'adre\u00e7a IP correcta. Som confiats, eh?</p>"},{"location":"SMX2-SXA-4/#mapa-conceptual","title":"Mapa conceptual","text":"<p>Vicent Jord\u00e0. Mapa conceptual - Servei DNS (CC BY-NC-SA)</p>"},{"location":"SMX2-SXA-4/#activitats-i-practiques","title":"Activitats i Pr\u00e0ctiques","text":"Butllet\u00ed d'activitats <ol> <li>Quina \u00e9s la funci\u00f3 principal del servei DNS?</li> <li>Quines caracter\u00edstiques t\u00e9 el servei DNS?</li> <li>Explica qu\u00e8 s\u00f3n els fitxers plans per a l'assignaci\u00f3 de noms. On estan emmagatzemats?</li> <li>Les bases de dades DNS es defineixen com jerarquitzades i distribu\u00efdes. \u00bfQu\u00e8 signifiquen estos conceptes? \u00bfQuina informaci\u00f3 emmagatzemen?</li> <li>Quins avantatges t\u00e9 l'\u00fas de servidors DNS locals respecte als externs.</li> <li>Quins tipus de mecanismes de resoluci\u00f3 de noms (consultes) existeixen? Explica el proc\u00e9s d'un d'ells. \u00c9s aconsellable recolzar-se en dibuixos i esquemes.</li> <li>Qu\u00e8 \u00e9s l'espai de noms de domini? Com s'estructura? Pots fer dibuixos i esquemes.</li> <li>Qu\u00e8 \u00e9s una zona? Quina relaci\u00f3 t\u00e9 amb el concepte de delegaci\u00f3?</li> <li>Qu\u00e8 vol dir que un servidor de noms \u00e9s autoritatiu respecte a un domini? Quina difer\u00e8ncia hi ha entre un servidor primari i un secundari?</li> <li>Nomena els tipus de registres que hi ha i quina utilitat tenen.</li> <li>Busca la p\u00e0gina web de ICAAN i explica amb les teues paraules quina \u00e9s la seua funci\u00f3.</li> <li>Explica amb les teues paraules com funciona un servidor cau (cach\u00e9).</li> </ol> P1. Resoluci\u00f3 de noms de dominim amb <code>nslookup</code> <p><code>nslookup</code> \u00e9s una eina que permet fer consultes DNS per resoldre noms de domini i obtenir informaci\u00f3 sobre els servidors DNS.</p> <p>Resoluci\u00f3 b\u00e0sica d'un domini:</p> <ul> <li> <p>Obre una terminal i executa: Bash<pre><code>nslookup google.com\n</code></pre></p> </li> <li> <p>An\u00e0lisi dels resultats: Observa com el nom de domini es resol en una adre\u00e7a IP. L'IP \u00e9s necess\u00e0ria perqu\u00e8 els ordinadors puguin trobar els servidors web correctes. Tamb\u00e9 observa quin servidor DNS ha estat utilitzat per a la consulta.</p> </li> </ul> <p>Consulta de servidors de correu (MX records):</p> <ul> <li>Els registres MX (Mail Exchange) indiquen els servidors responsables de gestionar el correu electr\u00f2nic per un domini. Executa:</li> </ul> Bash<pre><code>nslookup -query=mx gmail.com\n</code></pre> <ul> <li>An\u00e0lisi dels resultats: Quins servidors s\u00f3n els responsables de gestionar el correu de <code>gmail.com</code>?</li> </ul> <p>Canvi de servidor DNS per a la consulta:</p> <p>Per defecte, <code>nslookup</code> utilitza el servidor DNS configurat en el sistema. Podem utilitzar altres servidors, com ara el DNS de Google (8.8.8.8):</p> Bash<pre><code>nslookup google.com 8.8.8.8\n</code></pre> <ul> <li>An\u00e0lisi dels resultats: Comprova si els resultats s\u00f3n diferents quan utilitzem un servidor DNS diferent.</li> </ul> P2. Investigaci\u00f3 de registres DNS amb <code>dig</code> <p><code>dig</code> (Domain Information Groper) \u00e9s una eina potent per fer consultes DNS i obtenir informaci\u00f3 detallada dels registres associats a un domini. \u00c9s especialment \u00fatil per a l'an\u00e0lisi de registres espec\u00edfics.</p> <p>Consulta d'un domini:</p> <ul> <li>Obre la terminal i executa:</li> </ul> Bash<pre><code>dig google.com\n</code></pre> <ul> <li>An\u00e0lisi dels resultats: Analitza la informaci\u00f3 de les seccions \"Question Section\" i \"Answer Section\". Quina IP retorna el servidor DNS?</li> </ul> <p>Consulta de registres espec\u00edfics:</p> <ul> <li>Registres A (IPv4):</li> </ul> Bash<pre><code>dig google.com A\n</code></pre> <ul> <li>Registres MX (correu):</li> </ul> Bash<pre><code>dig gmail.com MX\n</code></pre> <ul> <li>Registres NS (servidors de noms):</li> </ul> Bash<pre><code>dig google.com NS\n</code></pre> <ul> <li>Registres TXT (informaci\u00f3 textual):</li> </ul> Bash<pre><code>dig google.com TXT\n</code></pre> <ul> <li>An\u00e0lisi dels resultats: Quins s\u00f3n els resultats per a cada tipus de registre? Quins servidors de noms gestiona <code>google.com</code>? Quins servidors de correu s'associen a <code>gmail.com</code>?</li> </ul> <p>Canvi de servidor DNS per a la consulta:</p> <ul> <li>Executa la mateixa comanda utilitzant un servidor DNS diferent, com el de Cloudflare (1.1.1.1):</li> </ul> Bash<pre><code>dig google.com @1.1.1.1\n</code></pre> <ul> <li>An\u00e0lisi dels resultats: Hi ha alguna difer\u00e8ncia en els resultats?</li> </ul>"},{"location":"SMX2-SXA-4/#annex-i-dig-amb-trace","title":"Annex I: <code>dig</code> amb <code>+trace</code>","text":"<p>La comanda <code>dig</code> amb l'opci\u00f3 <code>+trace</code> realitza una consulta de DNS (Domain Name System) que segueix la cadena de servidors DNS des del root fins al servidor autoritatiu per al domini sol\u00b7licitat. Aix\u00f2 permet veure com el sistema de noms de domini resol el nom de domini, pas a pas, comen\u00e7ant des dels servidors arrel i passant per cada nivell d'autoritat en el sistema DNS.</p> <p>Exemple de sortida de <code>dig +trace</code></p> <p>Suposem que executem:</p> <pre><code>dig +trace example.com\n</code></pre> <p>L'eixida t\u00edpica podria veure's aix\u00ed:</p> <pre><code>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; +trace example.com\n;; global options: +cmd\n.                       518400  IN  NS  a.root-servers.net.\n.                       518400  IN  NS  b.root-servers.net.\n.                       518400  IN  NS  c.root-servers.net.\n.                       518400  IN  NS  d.root-servers.net.\n.                       518400  IN  NS  e.root-servers.net.\n.                       518400  IN  NS  f.root-servers.net.\n.                       518400  IN  NS  g.root-servers.net.\n.                       518400  IN  NS  h.root-servers.net.\n.                       518400  IN  NS  i.root-servers.net.\n.                       518400  IN  NS  j.root-servers.net.\n.                       518400  IN  NS  k.root-servers.net.\n.                       518400  IN  NS  l.root-servers.net.\n.                       518400  IN  NS  m.root-servers.net.\n;; Received 108 bytes from 192.168.1.1#53(192.168.1.1) in 3 ms\n\ncom.                    172800  IN  NS  a.gtld-servers.net.\ncom.                    172800  IN  NS  b.gtld-servers.net.\ncom.                    172800  IN  NS  c.gtld-servers.net.\ncom.                    172800  IN  NS  d.gtld-servers.net.\ncom.                    172800  IN  NS  e.gtld-servers.net.\ncom.                    172800  IN  NS  f.gtld-servers.net.\n;; Received 397 bytes from 198.41.0.4#53(198.41.0.4) in 50 ms\n\nexample.com.            172800  IN  NS  ns1.example.net.\nexample.com.            172800  IN  NS  ns2.example.net.\n;; Received 118 bytes from 192.5.6.30#53(192.5.6.30) in 65 ms\n\nexample.com.            86400   IN  A   93.184.216.34\n;; Received 56 bytes from 192.0.2.1#53(192.0.2.1) in 42 ms\n</code></pre> <p>Desglossament de l'eixida:</p> <ol> <li> <p>Consultes als servidors arrel:</p> <ul> <li>Primer, la comanda consulta un dels servidors arrel (<code>a.root-servers.net</code>, <code>b.root-servers.net</code>, etc.). La resposta inclou els servidors de noms del domini de primer nivell (<code>com</code>, en aquest cas), indicant que <code>example.com</code> pertany al domini <code>.com</code>.</li> </ul> </li> <li> <p>Consulta als servidors de domini de primer nivell (TLD):</p> <ul> <li>Despr\u00e9s, consulta un dels servidors TLD (<code>a.gtld-servers.net</code>, <code>b.gtld-servers.net</code>, etc.) per al domini <code>.com</code>. Els servidors TLD proporcionen els servidors de noms autoritaris per al domini <code>example.com</code>.</li> </ul> </li> <li> <p>Consulta als servidors autoritaris:</p> <ul> <li>Despr\u00e9s, es realitza una consulta als servidors autoritaris per a <code>example.com</code>, en aquest cas <code>ns1.example.net</code> i <code>ns2.example.net</code>. Aquests s\u00f3n els servidors que contenen la informaci\u00f3 final sobre el domini sol\u00b7licitat.</li> </ul> </li> <li> <p>Resposta final:</p> <ul> <li>Finalment, un dels servidors autoritaris retorna l'adre\u00e7a IP associada amb <code>example.com</code> (en aquest cas, 93.184.216.34).</li> </ul> </li> </ol> <p>Aspectes clau en l'eixida:</p> <ul> <li>NS (Name Server): Indica els servidors de noms que responen pel domini en cada nivell.</li> <li>A (Address): L'adre\u00e7a IP associada amb el domini sol\u00b7licitat.</li> <li>Temps de resposta: El temps en mil\u00b7lisegons (<code>ms</code>) indica quant de temps va trigar a rebre la resposta des del servidor corresponent.</li> <li>Pas a pas: La comanda mostra cada consulta que es realitza i com es resol, permetent veure la cadena completa de servidors DNS.</li> </ul> <p>Per qu\u00e8 usar <code>+trace</code>?</p> <p>Usar <code>+trace</code> \u00e9s \u00fatil per depurar problemes amb la resoluci\u00f3 de noms, ja que permet veure exactament quins servidors estan involucrats i quines respostes estan retornant. Aix\u00f2 \u00e9s \u00fatil per detectar problemes de configuraci\u00f3, com si un servidor DNS autoritari no est\u00e0 responent correctament o si hi ha un error en els registres DNS.</p>"},{"location":"manuals/CanviMirror/","title":"Canvi del Mirror en Ubuntu 24.04 LTS","text":"<p>Degut al mal funcionament del mirror oficial d'Ubuntu a la xarxa de Conselleria, haurem de canviar el mirror dels nostres sistemes.</p>"},{"location":"manuals/CanviMirror/#localitzant-el-fitxer-de-fonts","title":"Localitzant el fitxer de fonts","text":"<p>Antigament, els mirrors d'ubuntu anaven definits al fitxer <code>/etc/apt/sources.list</code>. Per\u00f2 ja fa varies versions, que aquest fitxer ens envia a un directori on podem tindre diversos fitxers de mirrors. A la versi\u00f3 24.04 es fa \u00fas d'un fitxer localitzat en <code>/etc/apt/sources.list.d/ubuntu.sources</code> on podem trobar els mirrors en format descriptiu (antigament s'emprava el format en una sola linia).</p>"},{"location":"manuals/CanviMirror/#canviant-el-mirror","title":"Canviant el mirror","text":"<p>Per tant, el que farem ser\u00e0 consultar aquest fitxer i editar-lo:</p> Bash<pre><code>sudo nano /etc/apt/sources.list.d/ubuntu.sources\n</code></pre> <p>canviant el contingut del fitxer perqu\u00e8 fa\u00e7a \u00fas del mirror del Centro Inform\u00e1tico Cient\u00edfico de Andalucia (CICA), deixant el fitxer aix\u00ed:</p> Bash<pre><code>Types: deb deb-src\nURIs: http://ubuntu.cica.es/ubuntu/\nSuites: noble noble-security noble-updates noble-backports\nComponents: main restricted universe multiverse\nSigned-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg\n</code></pre> <p>NOTA: no \u00e9s necessari escriure-ho tot de zero, ser\u00e0 suficient amb canviar algunes linies!</p> <p>Una vegada modificat el fitxer, el guardem i actualitzem les fonts del sistema:</p> Bash<pre><code>sudo apt update\n</code></pre>"},{"location":"manuals/CanviMirror/#a-tenir-en-compte","title":"A tenir en compte","text":"<p>En el moment de crear aquest manual (Octubre 2024), el mirror del CICA \u00e9s un dels que millor funciona des de la xarxa del centre. Per\u00f2 existeixen altres, com el de la Universidad de Zaragoza que tamb\u00e9 funcionen b\u00e9. Per tal de canviar-lo, sols hauriem d'editar la l\u00ednia que fa refer\u00e8ncia a aquest (URIs):</p> Bash<pre><code>Types: deb deb-src\nURIs: http://softlibre.unizar.es/ubuntu/archive/\nSuites: noble noble-security noble-updates noble-backports\nComponents: main restricted universe multiverse\nSigned-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg\n</code></pre> <p>o incl\u00fas tindre els dos posats:</p> Bash<pre><code>Types: deb deb-src\nURIs: http://ubuntu.cica.es/ubuntu/ http://softlibre.unizar.es/ubuntu/archive/\nSuites: noble noble-security noble-updates noble-backports\nComponents: main restricted universe multiverse\nSigned-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg\n</code></pre>"},{"location":"manuals/CanviMirror/#mes-info","title":"M\u00e9s info","text":"<ul> <li>Ubuntu Manuals</li> </ul>"},{"location":"manuals/ManSolMachine_id/","title":"Soluci\u00f3 del problema de duplicaci\u00f3 de Machine-ID en m\u00e0quines clonades de base Debian a VirtualBox","text":""},{"location":"manuals/ManSolMachine_id/#introduccio","title":"Introducci\u00f3","text":"<p>Quan es configuren m\u00e0quines virtuals (VM) clonades en VirtualBox, com en el cas d'un escenari DHCP, pot sorgir un problema relacionat amb la duplicaci\u00f3 del Machine-ID. Aix\u00f2 \u00e9s especialment rellevant en m\u00e0quines clonades, ja que la identificaci\u00f3 \u00fanica de la m\u00e0quina \u00e9s clau perqu\u00e8 el servidor DHCP pugui assignar adreces IP distintes a cada m\u00e0quina.</p> <p>El Machine-ID \u00e9s un identificador \u00fanic que es genera durant la instal\u00b7laci\u00f3 del sistema operatiu. No obstant aix\u00f2, quan es clonen m\u00e0quines virtuals utilitzant la funcionalitat de clonaci\u00f3 enlla\u00e7ada de VirtualBox, es mantenen els mateixos fitxers del sistema, incloent el Machine-ID, cosa que provoca que les m\u00e0quines clonades siguin vistes com la mateixa m\u00e0quina pel servidor DHCP, encara que tinguen diferents adreces MAC.</p>"},{"location":"manuals/ManSolMachine_id/#context-del-problema","title":"Context del problema","text":"<p>Quan es clona una m\u00e0quina a VirtualBox, malgrat que es generen noves adreces MAC, els clons comparteixen altres caracter\u00edstiques, com ara el Machine-ID. Aquest identificador es guarda al fitxer:</p> Bash<pre><code>/etc/machine-id\n</code></pre> <p>El servidor DHCP utilitza tant la MAC address com el Machine-ID per identificar els clients. Si el Machine-ID \u00e9s el mateix per a totes les m\u00e0quines clonades, el servidor DHCP els assignar\u00e0 la mateixa IP, independentment de la difer\u00e8ncia de MAC address.</p>"},{"location":"manuals/ManSolMachine_id/#solucio-regenerar-el-machine-id","title":"Soluci\u00f3: Regenerar el Machine-ID","text":"<p>Per solucionar aquest problema, cal regenerar un nou Machine-ID per a cada m\u00e0quina clonada. A continuaci\u00f3, es detallen els passos per fer-ho.</p>"},{"location":"manuals/ManSolMachine_id/#verificar-el-machine-id-actual","title":"Verificar el Machine-ID actual","text":"<p>Per comprovar quin \u00e9s el Machine-ID actual, pots executar el seg\u00fcent comandament:</p> Bash<pre><code>cat /etc/machine-id\n</code></pre>"},{"location":"manuals/ManSolMachine_id/#eliminar-lantic-machine-id","title":"Eliminar l'antic Machine-ID","text":"<p>Per generar un nou Machine-ID, primer cal eliminar l'actual:</p> Bash<pre><code>sudo rm /etc/machine-id\n</code></pre>"},{"location":"manuals/ManSolMachine_id/#regenerar-el-machine-id","title":"Regenerar el Machine-ID","text":"<p>Un cop eliminat l'antic Machine-ID, pots generar un de nou amb la seg\u00fcent comanda:</p> Bash<pre><code>sudo systemd-machine-id-setup\n</code></pre>"},{"location":"manuals/ManSolMachine_id/#reiniciar-la-maquina","title":"Reiniciar la m\u00e0quina","text":"<p>Despr\u00e9s de regenerar el Machine-ID, reinicia la m\u00e0quina per aplicar els canvis:</p> Bash<pre><code>sudo reboot\n</code></pre>"},{"location":"manuals/ManSolMachine_id/#verificar-que-el-problema-sha-solucionat","title":"Verificar que el problema s'ha solucionat","text":"<p>Despr\u00e9s de reiniciar la m\u00e0quina, pots verificar que el Machine-ID s'ha canviat:</p> Bash<pre><code>cat /etc/machine-id\n</code></pre> <p>Ara, quan les m\u00e0quines clonades es connectin al servidor DHCP, haurien de rebre adreces IP diferents, ja que tant la MAC address com el Machine-ID seran \u00fanics.</p>"},{"location":"manuals/ManUbuntuServerDocker/","title":"Instal\u00b7laci\u00f3 de Docker en Ubuntu Server 24.04 LTS","text":""},{"location":"manuals/ManUbuntuServerDocker/#que-es-docker","title":"Qu\u00e8 \u00e9s Docker?","text":"<p>Docker \u00e9s una plataforma de codi obert que automatitza el desplegament d'aplicacions dins de contenidors de programari. Els contenidors permeten empaquetar una aplicaci\u00f3 amb totes les seves depend\u00e8ncies i executar-la de manera consistent en qualsevol entorn.</p>"},{"location":"manuals/ManUbuntuServerDocker/#avantatges-dutilitzar-docker-en-un-ubuntu-server","title":"Avantatges d'utilitzar Docker en un Ubuntu Server","text":"<ul> <li>Portabilitat: Els contenidors Docker poden executar-se en qualsevol sistema que tingui Docker instal\u00b7lat, independentment de les difer\u00e8ncies en les configuracions del sistema operatiu.</li> <li>A\u00efllament: Cada contenidor s'executa de manera a\u00efllada, la qual cosa evita conflictes entre aplicacions i millora la seguretat.</li> <li>Efici\u00e8ncia: Docker utilitza menys recursos que les m\u00e0quines virtuals tradicionals, ja que comparteix el nucli del sistema operatiu amb els contenidors.</li> <li>Desplegament r\u00e0pid: La creaci\u00f3 i el desplegament de contenidors \u00e9s molt m\u00e9s r\u00e0pid que la configuraci\u00f3 de m\u00e0quines virtuals.</li> <li>Escalabilitat: Docker facilita l'escalabilitat horitzontal, permetent desplegar m\u00faltiples inst\u00e0ncies d'una aplicaci\u00f3 de manera senzilla.</li> <li>Gesti\u00f3 senzilla: Amb Docker Compose i altres eines, \u00e9s f\u00e0cil gestionar m\u00faltiples contenidors i les seves configuracions.</li> </ul> <p>Utilitzar Docker en un Ubuntu Server permet una gesti\u00f3 m\u00e9s eficient i flexible dels serveis de xarxa, millorant la portabilitat, l'a\u00efllament i l'escalabilitat de les aplicacions.</p>"},{"location":"manuals/ManUbuntuServerDocker/#opcional-installar-docker-a-traves-dssh","title":"OPCIONAL: Instal\u00b7lar Docker a trav\u00e9s d'SSH","text":"<p>Per poder copiar i enganxar fragments de codi d'aquesta pr\u00e0ctica, es recomana accedir al nostre Servidor mitjan\u00e7ant SSH. Per tant, per poder comunicar la m\u00e0quina nostra amb la del VirtualBox, haurem de posar l'adaptador de la m\u00e0quina Virtual en mode pont. Una vegada arrancada la m\u00e0quina ens connectarem a ella amb els comandament: <code>ssh adminserver@IP_de_la_m\u00e0quinaV</code> i tot seguit, ens logarem amb la constrassenya d'administraci\u00f3.</p>"},{"location":"manuals/ManUbuntuServerDocker/#installacio","title":"Instal\u00b7laci\u00f3","text":""},{"location":"manuals/ManUbuntuServerDocker/#afegir-la-clau-gpg-oficial-de-docker","title":"Afegir la clau GPG oficial de Docker","text":"Bash<pre><code>sudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#afegir-el-repositori-a-les-fonts-apt","title":"Afegir el repositori a les fonts APT","text":"Bash<pre><code>echo \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#installar-lultimma-versio","title":"Instal\u00b7lar l'\u00faltimma versi\u00f3","text":"Bash<pre><code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#comprovar-lestat-de-docker","title":"Comprovar l'estat de Docker","text":"Bash<pre><code>sudo systemctl status docker\ndocker --version\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#afegir-lusuari-adminserver-al-grup-docker","title":"Afegir l'usuari <code>adminserver</code> al grup <code>docker</code>","text":"Bash<pre><code>sudo usermod -aG docker adminserver\nsu - adminserver\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#comprovar-usuaris-grup-docker","title":"Comprovar usuaris grup Docker","text":"Bash<pre><code>id -nG\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#veure-els-comandaments-de-docker","title":"Veure els comandaments de Docker","text":"Bash<pre><code>docker\n</code></pre>"},{"location":"manuals/ManUbuntuServerDocker/#postinstallacio-descarregar-imatge-hello-world","title":"Postinstal\u00b7laci\u00f3: Descarregar imatge Hello-World","text":"Bash<pre><code>docker run hello-world\n</code></pre> <p>Si tot ha anat b\u00e9, haur\u00edem de veure alguna cosa semblant a a\u00e7\u00f2:</p> <p></p>"},{"location":"manuals/ManUbuntuServerDocker/#altres-comandaments-utils-de-docker","title":"Altres comandaments \u00fatils de Docker","text":"<ul> <li>BUSCAR IMATGE UBUNTU EN DOCKERHUB</li> </ul> <p><code>docker search ubuntu</code></p> <ul> <li>DESCARREGAR IMATGE UBUNTU</li> </ul> <p><code>docker pull ubuntu</code></p> <ul> <li>VEURE IMATGES DOCKER</li> </ul> <p><code>docker images</code></p> <ul> <li>EXECUTAR UN CONTENIDOR DE DOCKER</li> </ul> <p><code>docker run -it ubuntu</code> <code>apt update</code> <code>exit</code></p> <ul> <li>ADMINISTRAR CONTENIDORS DOCKER / VEURE CONTENIDORS ACTIUS</li> </ul> <p><code>docker ps</code></p> <ul> <li>VEURE CONTENIDORS ACTIUS I INACTIUS</li> </ul> <p><code>docker ps -a</code></p> <ul> <li>VEURE \u00daLTIM CONTENIDOR CREAT</li> </ul> <p><code>docker ps -l</code></p> <ul> <li>INICIAR UN CONTENIDOR</li> </ul> <p><code>docker start IDCONTENIDOR</code></p> <ul> <li>DETENIR CONTENIDOR</li> </ul> <p><code>docker stop IDCONTENIDOR</code></p> <ul> <li>ELIMINAR CONTENIDOR</li> </ul> <p><code>docker rm IDCONTENIDOR</code></p>"}]}